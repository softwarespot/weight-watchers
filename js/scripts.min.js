var App={};App.core=function(n,t,e,r){function i(){D||(NProgress.configure({minimum:.1,showSpinner:!1}),D=!0)}function o(){D=!1}function u(){return U}function s(){return j}function c(){return B}function a(n){p(n)&&(B=n)}function f(n){if(H(n))for(;n.length>0;)n.pop()}function l(n){return H(n)&&0!==n.length?n[n.length-1]:r}function g(n,t){return G.call(n,t)}function p(n){return n===!0||n===!1||b(n)&&M.call(n)===L.BOOLEAN}function h(n){if(I(n)||0===n)return!0;if(H(n)||w(n))return 0===n.length;for(var t in n)if(g(n,t))return!1;return!0}function d(n){return O(n)&&x.FLOAT.test(""+n)}function m(n){var t=A(n)?M.call(n):"";return t===L.FUNCTION||t===L.GENERATOR}function N(n){return O(n)&&x.INTEGER.test(""+n)}function E(n){return n instanceof e}function v(n){return E(n)&&0!==n.length}function y(n){return null!==n}function T(n){return null===n}function I(n){return T(n)||R(n)}function O(n){return"number"==typeof n||b(n)&&M.call(n)===L.NUMBER}function A(n){var t=typeof n;return!!n&&("object"===t||"function"===t)}function b(n){return!!n&&"object"==typeof n}function S(n){return b(n)?n.constructor&&!g(n.constructor.prototype,"isPrototypeOf")?!1:!0:!1}function w(n){return"string"==typeof n||M.call(n)===L.STRING}function P(n){return w(n)&&x.FLOAT.test(n)}function _(n){return w(n)&&x.INTEGER.test(n)}function F(n){return w(n)&&(x.FLOAT.test(n)||x.INTEGER.test(n))}function R(n){return n===r}function C(n,t){return O(n)&&O(t)?Math.floor(Math.random()*t+n):0}var j="1.0.0",U="SoftwareSpot",D=!1,L={BOOLEAN:"[object Boolean]",FUNCTION:"[object Function]",GENERATOR:"[object GeneratorFunction]",NUMBER:"[object Number]",STRING:"[object String]"},k=Object.prototype,G=k.hasOwnProperty,M=k.toString,x={FLOAT:/(?:^-?\d+\.\d+$)/,INTEGER:/(?:^-?\d+$)/},B=!1,H=Array.isArray;return e(function(){i()}),{init:i,destroy:o,getAppName:u,getVersion:s,isDebug:c,setIsDebug:a,arrayClear:f,arrayPeek:l,has:g,isArray:H,isBoolean:p,isEmpty:h,isFloat:d,isFunction:m,isInteger:N,isjQuery:E,isjQueryNotEmpty:v,isNotNull:y,isNull:T,isNullOrUndefined:I,isNumber:O,isObject:A,isObjectLiteral:S,isString:w,isStringFloat:P,isStringInteger:_,isStringNumber:F,isUndefined:R,randomNumber:C}}(this,this.document,this.jQuery),App.core.api=function(n,t,e,r){function i(){I||(s(),c(),I=!0)}function o(){O=null,I=!1}function u(){return E}function s(){O=e(t)}function c(){NProgress.configure({minimum:.1,showSpinner:!1}),O.ajaxStart(function(){NProgress.start()}),O.ajaxStop(function(){NProgress.done()})}function a(n){if(n.status>=T.OK&&n.status<T.MULTIPLE_CHOICES)return n;var t=Error(n.statusText);throw t.response=n,t}function f(n){var t=n.json();return t?t:null}function l(t,e,i,o){return new Promise(function(u,s){if(t=N(t,i),r.isDebug())r.isNull(t)&&s(),n.setTimeout(function(){0===r.randomNumber(0,1e3)?s():u()},v);else{var c={method:e,headers:{Accept:"application/json","Content-Type":"application/json"}},l=e===y.PUT||e===y.POST;l&&(n.console.log("fetch() body...",o),c.body=n.JSON.stringify(o)),n.console.log("fetch() in progress...",t,c);var g=n.fetch(t,c);g.then(a),l&&g.then(f),g.then(function(n){u(n)}),g["catch"](function(){s()})}})}function g(){NProgress.start(),n.setTimeout(NProgress.done,v)}function p(n,t){return new Promise(function(e,r){NProgress.start(),l(n,y.DELETE,t).then(function(n){NProgress.done(),e(n)})["catch"](function(n){NProgress.done(),r(n)})})}function h(n,t){return new Promise(function(e,r){NProgress.start(),l(n,y.GET,t).then(function(n){NProgress.done(),e(n)})["catch"](function(n){NProgress.done(),r(n)})})}function d(n,t,e){return new Promise(function(r,i){NProgress.start(),l(n,y.PUT,t,e).then(function(n){NProgress.done(),r(n)})["catch"](function(n){NProgress.done(),i(n)})})}function m(n,t,e){return new Promise(function(r,i){NProgress.start(),l(n,y.POST,t,e).then(function(n){NProgress.done(),r(n)})["catch"](function(n){NProgress.done(),i(n)})})}function N(n,t){if(!r.isString(n)||!r.isObjectLiteral(t))return null;for(var e=""+n,i=/{([^\}]+)}/g;;){var o=i.exec(e);if(r.isNull(o))break;var u=o[1];if(r.has(t,u)&&!r.isUndefined(t[u])){var s=o[0];n=n.replace(s,t[u])}}return n}var E="1.0.0",v=750,y={DELETE:"delete",GET:"get",POST:"post",PUT:"put"},T={OK:200,CREATED:201,NO_CONTENT:204,MULTIPLE_CHOICES:300,NOT_MODIFIED:304,BAD_REQUEST:400,UNAUTHORIZED:401,FORBIDDEN:403,NOT_FOUND:404,METHOD_NOT_ALLOWED:405,NOT_ACCEPTABLE:406,CONFLICT:409,INTERNAL_SERVER_ERROR:500,NOT_IMPLEMENTED:501},I=!1,O=null;return e(function(){i({})}),{init:i,destroy:o,getVersion:u,Methods:y,HTTPStatus:T,fetch:g,"delete":p,get:h,put:d,post:m,parseUrl:N}}(this,this.document,this.jQuery,App.core),App.core.emitter=function(n,t,e,r){function i(){return l}function o(n){return r.isString(n)&&n.trim().length>0}function u(n){return r.isArray(n)&&n.length>0}function s(){g={}}function c(n){if(o(n)){var t=g[n];if(u(t)){for(var e=[],r=1,i=arguments.length;i>r;r++)e.push(arguments[r]);t.forEach(function(n){n.apply(this,e)})}}}function a(n,t){if(o(n)&&r.isFunction(t)){var e=g[n];if(u(e)){var i=e.indexOf(t);-1!==i&&e.splice(i,1)}}}function f(n,t){if(o(n)&&r.isFunction(t)){g[n]=g[n]||[];var e=g[n];-1===e.indexOf(t)&&e.push(t)}}var l="1.0.0",g={};return{getVersion:i,clear:s,emit:c,off:a,on:f}}(this,this.document,this.jQuery,App.core),App.core.events={NAVIGATION_CLICK:"click.navigation.app"},App.navigation=function(n,t,e,r){function i(){a(),s(),p=!0}function o(){c(),h=null,d=null,p=!1}function u(){return l}function s(){g&&c(),d.on(m.navigation,m.navigationFn),g=!0}function c(){g&&(d.off(m.navigation,m.navigationFn),g=!1)}function a(){h=e("html, body"),d=e("header").find("a")}function f(n,t){r.isUndefined(t)&&(t=500),h.animate({scrollTop:n.offset().top},t)}var l="1.0.0",g=!1,p=!1,h=null,d=null,m={navigation:"click.app.navigation",navigationFn:function(n){var t=n.currentTarget.getAttribute("href"),i="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",o=RegExp("^#"+i+"$");if(r.emitter.emit(r.events.NAVIGATION_CLICK,t),!o.test(t))return!0;n.preventDefault();var u=e(t);return r.isjQueryNotEmpty(u)?(f(u,500),!1):!1}};return e(function(){i()}),{init:i,destroy:o,getVersion:u}}(this,this.document,this.jQuery,this.App.core),App.user=function(n,t,e,r){function i(){g||(a(),s(),g=!0)}function o(){g=!1}function u(){return f}function s(){l&&c(),r.emitter.on(p.signIn,p.signInFn),l=!0}function c(){l&&(r.emitter.off(p.signInEvent,p.signIn),l=!1)}function a(){}var f="1.0.0",l=!1,g=!1,p={signIn:r.events.NAVIGATION_CLICK,signInFn:function(t){"#signin-section"===t&&n.console.log("Sign in was called, but nothing took place as of yet")}};return e(function(){i()}),{init:i,destroy:o,getVersion:u}}(this,this.document,this.jQuery,App.core),App.weight=function(n,t,e,r,i){function o(n){if(!T){var t={};e.extend(t,n),C=n.data_id,j=n.templates.weight_list,f(n.dom),c(),F.prop("disabled",!0),R.addClass("hide"),A=A[r.randomNumber(0,A.length-1)];var i=r.api.get(v.WEIGHTS_USERNAME,{username:"softwarespot"});i.then(function(n){if(d(),r.isDebug())for(var t=0,e=r.randomNumber(5,20);e>t;t++)l(g(1*r.randomNumber(45,200)));else n.forEach(function(n){l(n)});L.set(I),d(!0)}),i["catch"](function(){d(!0)}),T=!0}}function u(){a(),b=null,S=null,w=null,w=null,_=null,F=null,R=null,r.arrayClear(I),T=!1}function s(){return N}function c(){y&&a(),b.on(D.remove,"["+C+"]",D.removeFn),w.on(D.submit,D.submitFn),P.on(D.keyup,D.keyupFn),_.on(D.reset,D.resetFn),y=!0}function a(){y&&(b.off(D.remove,"["+C+"]",D.removeFn),w.off(D.submit,D.submitFn),P.off(D.keyup,D.keyupFn),_.off(D.reset,D.resetFn),y=!1)}function f(n){b=e(t),S=e(n.weight_list),w=e(n.forms.weight),P=w.find('input[type="text"]'),_=w.find('[type="reset"]'),F=w.find('input[type="submit"]'),R=e(n.weight_list_error)}function l(n){return r.isNull(n)?!1:(I.push(n),!0)}function g(n){if(r.isFloat(n)||(n=parseFloat(n)),0===n)return null;var t=moment().unix();return{id:O++,value:n,time:t,username:A,iso8601:moment.unix(t).toISOString()}}function p(n){if(r.isInteger(n)||(n=parseInt(n)),0!==n)for(var t=0,e=I.length;e>t;t++){var i=I[t];if(i.id===n){I.splice(t,1);break}}}function h(n){S.handlebars("add",j,n,{remove_type:"same",validate:!r.isEmpty(n)})}function d(n){I=L.get();var t=r.arrayPeek(I);r.isUndefined(t)||(O=t.id),O++,r.isBoolean(n)&&n&&h(I)}function m(n){return r.isString(n)||(n=""+n),n.trim().length>0&&U.test(n)}var N="1.0.0",E="772C021E-61EA-4B15-8330-B2274E891371",v={WEIGHTS:"/weights",WEIGHTS_USERNAME:"/weights/{username}",WEIGHT_USERNAME_ID:"/weights/{id}",USERS:"users"},y=!1,T=!1,I=[],O=0,A=["softwarespot","squidge","brainbox"],b=null,S=null,w=null,P=null,_=null,F=null,R=null,C=null,j=null,U=/^(?!0+)(?:\d+(?:\.\d)?)$/,D={keyup:"keyup.app.weight",remove:"click.remove.app.weight",reset:"click.reset.app.weight",submit:"submit.app.weight",keyupFn:function(n){n.preventDefault();var t=n.currentTarget.value;return m(t)?(F.prop("disabled",!1),i):(F.prop("disabled",!0),i)},resetFn:function(){NProgress.done(),R.addClass("hide"),L.clear(),r.arrayClear(I),h(I)},removeFn:function(t){t.preventDefault();var e=t.currentTarget.getAttribute(C),i=r.api.get(v.WEIGHTS_USERNAME,{username:"softwarespot",id:e});i.then(function(n){e=r.isDebug()?e:n.id,p(e),L.set(I),h(I)}),i["catch"](function(){n.alert("Some error occurred with DELETE'in the weight value")})},submitFn:function(t){t.preventDefault();var e=t.currentTarget[0];F.prop("disabled",!0);var o=e.value;if(!m(o))return R.removeClass("hide"),i;P.val(""),R.addClass("hide");var u=r.api.post(v.WEIGHTS_USERNAME,{username:"softwarespot"});u.then(function(n){n=r.isDebug()?g(o):n,l(n)&&(L.set(I),h(I))}),u["catch"](function(){n.alert("Some error occurred with POST'in the weight value")})}},L={key:E+"_app.weight_list",_has:null,clear:function(){try{n.sessionStorage.removeItem(this.key)}catch(t){n.console.log("An error occurred with _session.clear()")}},has:function(){if(this._has)return this._has();var t=n.sessionStorage;return r.isObject(t)&&"key"in t&&"getItem"in t&&"setItem"in t&&"removeItem"in t&&"clear"in t},remove:this.clear,get:function(){var t=null;try{t=n.sessionStorage.getItem(this.key)}catch(e){n.console.log("An error occurred with _session.get()")}return r.isNullOrUndefined(t)?[]:JSON.parse(t)},set:function(t){if(r.isArray(t))try{n.sessionStorage.setItem(this.key,JSON.stringify(t))}catch(e){n.console.log("An error occurred with _session.set()")}}};return e(function(){o({data_id:"data-weight-id",dom:{forms:{weight:"#weight-post-form"},weight_list:"#weight-list",weight_list_error:"#weight-list-error"},templates:{weight_list:"#template-weight-list"}})}),{init:o,destroy:u,getVersion:s,isValidWeight:m}}(this,this.document,this.jQuery,App.core);