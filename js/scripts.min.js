var App={};App.core=function(t,e,n,r){function i(t){if(!L){var e={};n.extend(e,t),NProgress.configure({minimum:.1,showSpinner:!1}),L=!0}}function o(){L=!1}function u(){return C}function s(){return j}function a(){return B}function c(t){p(t)&&(B=t)}function f(t){if(H(t))for(;t.length>0;)t.pop()}function l(t){return H(t)&&0!==t.length?t[t.length-1]:r}function g(t,e){return M.call(t,e)}function p(t){return t===!0||t===!1||w(t)&&x.call(t)===k.BOOLEAN}function d(t){if(b(t))return!0;if(H(t)||A(t))return 0===t.length;for(var e in t)if(g(t,e))return!1;return!0}function h(t){return S(t)&&G.FLOAT.test(""+t)}function m(t){return O(t)&&x.call(t)===k.FUNCTION}function N(t){return S(t)&&G.INTEGER.test(""+t)}function E(t){return t instanceof n}function v(t){return E(t)&&0!==t.length}function T(t){return null!==t}function y(t){return null===t}function b(t){return y(t)||R(t)}function S(t){return"number"==typeof t||w(t)&&x.call(t)===k.NUMBER}function O(t){var e=typeof t;return!!t&&("object"===e||"function"===e)}function w(t){return!!t&&"object"==typeof t}function P(t){return w(t)?t.constructor&&!g(t.constructor.prototype,"isPrototypeOf")?!1:!0:!1}function A(t){return"string"==typeof t||x.call(t)===k.STRING}function I(t){return A(t)&&G.FLOAT.test(t)}function _(t){return A(t)&&G.INTEGER.test(t)}function D(t){return A(t)&&(G.FLOAT.test(t)||G.INTEGER.test(t))}function R(t){return t===r}function U(t,e){return S(t)&&S(e)?Math.floor(Math.random()*e+t):0}var j="1.0.0",C="SoftwareSpot",L=!1,k={BOOLEAN:"[object Boolean]",FUNCTION:"[object Function]",NUMBER:"[object Number]",STRING:"[object String]"},F=Object.prototype,M=F.hasOwnProperty,x=F.toString,G={FLOAT:/(?:^-?\d+\.\d+$)/,INTEGER:/(?:^-?\d+$)/},B=!1,H=Array.isArray;return n(function(){i({})}),{init:i,destroy:o,getAppName:u,getVersion:s,isDebug:a,setIsDebug:c,arrayClear:f,arrayPeek:l,has:g,isArray:H,isBoolean:p,isEmpty:d,isFloat:h,isFunction:m,isInteger:N,isjQuery:E,isjQueryNotEmpty:v,isNotNull:T,isNull:y,isNullOrUndefined:b,isNumber:S,isObject:O,isObjectLiteral:P,isString:A,isStringFloat:I,isStringInteger:_,isStringNumber:D,isUndefined:R,randomNumber:U}}(this,this.document,this.jQuery),App.core.api=function(t,e,n,r){function i(t){if(!b){var e={};n.extend(e,t),s(),a(),b=!0}}function o(){S=null,b=!1}function u(){return E}function s(){S=n(e)}function a(){NProgress.configure({minimum:.1,showSpinner:!1}),S.ajaxStart(function(){NProgress.start()}),S.ajaxStop(function(){NProgress.done()})}function c(){NProgress.start(),t.setTimeout(NProgress.done,v)}function f(t){if(t.status>=y.OK&&t.status<y.MULTIPLE_CHOICES)return t;var e=Error(t.statusText);throw e.response=t,e}function l(t){var e=t.json();return e?e:null}function g(e,n,i,o){return new Promise(function(u,s){if(e=N(e,i),r.isDebug())r.isNull(e)&&s(),t.setTimeout(function(){0===r.randomNumber(0,1e3)?s():u()},v);else{var a={method:n,headers:{Accept:"application/json","Content-Type":"application/json"}},c=n===T.PUT||n===T.POST;c&&(t.console.log("fetch() body...",o),a.body=t.JSON.stringify(o)),t.console.log("fetch() in progress...",e,a);var g=t.fetch(e,a);g.then(f),c&&g.then(l),g.then(function(t){u(t)}),g["catch"](function(){s()})}})}function p(t,e){return new Promise(function(n,r){NProgress.start(),g(t,T.DELETE,e).then(function(t){NProgress.done(),n(t)})["catch"](function(t){NProgress.done(),r(t)})})}function d(t,e){return new Promise(function(n,r){NProgress.start(),g(t,T.GET,e).then(function(t){NProgress.done(),n(t)})["catch"](function(t){NProgress.done(),r(t)})})}function h(t,e,n){return new Promise(function(r,i){NProgress.start(),g(t,T.PUT,e,n).then(function(t){NProgress.done(),r(t)})["catch"](function(t){NProgress.done(),i(t)})})}function m(t,e,n){return new Promise(function(r,i){NProgress.start(),g(t,T.POST,e,n).then(function(t){NProgress.done(),r(t)})["catch"](function(t){NProgress.done(),i(t)})})}function N(t,e){if(!r.isString(t)||!r.isObjectLiteral(e))return null;for(var n=""+t,i=/{([^\}]+)}/g;;){var o=i.exec(n);if(r.isNull(o))break;var u=o[1];if(r.has(e,u)&&!r.isUndefined(e[u])){var s=o[0];t=t.replace(s,e[u])}}return t}var E="1.0.0",v=750,T={DELETE:"delete",GET:"get",POST:"post",PUT:"put"},y={OK:200,CREATED:201,NO_CONTENT:204,MULTIPLE_CHOICES:300,NOT_MODIFIED:304,BAD_REQUEST:400,UNAUTHORIZED:401,FORBIDDEN:403,NOT_FOUND:404,METHOD_NOT_ALLOWED:405,NOT_ACCEPTABLE:406,CONFLICT:409,INTERNAL_SERVER_ERROR:500,NOT_IMPLEMENTED:501},b=!1,S=null;return n(function(){i({})}),{init:i,destroy:o,getVersion:u,Methods:T,HTTPStatus:y,fetch:c,"delete":p,get:d,put:h,post:m,parseUrl:N}}(this,this.document,this.jQuery,App.core),App.navigation=function(t,e,n,r){function i(t){var e={};n.extend(e,t),s(),a(),g=!0}function o(){c(),p=null,d=null,g=!1}function u(){return l}function s(){p=n("html, body"),d=n("header").find("a")}function a(){h&&c(),d.on(m.click,m.navigation),h=!0}function c(){h&&(d.off(m.click,m.navigation),h=!1)}function f(t,e){r.isUndefined(e)&&(e=500),p.animate({scrollTop:t.offset().top},e)}var l="1.0.0",g=!1,p=null,d=null,h=!1,m={click:"click.app.navigation",navigation:function(t){var e=t.currentTarget.getAttribute("href"),r="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",i=RegExp("^#"+r+"$");if(!i.test(e))return!0;t.preventDefault();var o=n(e);return 0===o.length?!1:(f(o,500),!1)}};return n(function(){i()}),{init:i,destroy:o,getVersion:u}}(this,this.document,this.jQuery,this.App.core),App.weight=function(t,e,n,r,i){function o(t){if(!T){var e={};n.extend(e,t),U=t.data_id,j=t.templates.weight_list,a(t.dom),c(),D.prop("disabled",!0),R.addClass("hide"),O=O[r.randomNumber(0,O.length-1)];var i=r.api.get(v.WEIGHTS_USERNAME,{username:"softwarespot"});i.then(function(t){if(h(),r.isDebug())for(var e=0,n=r.randomNumber(5,20);n>e;e++)l(g(1*r.randomNumber(45,200)));else t.forEach(function(t){l(t)});k.set(b),h(!0)}),i["catch"](function(){h(!0)}),T=!0}}function u(){f(),w=null,P=null,A=null,A=null,_=null,D=null,R=null,r.arrayClear(b),T=!1}function s(){return N}function a(t){w=n(e),P=n(t.weight_list),A=n(t.forms.weight),I=A.find('input[type="text"]'),_=A.find('[type="reset"]'),D=A.find('input[type="submit"]'),R=n(t.weight_list_error)}function c(){y&&f(),w.on(L.remove,"["+U+"]",L.removal),A.on(L.submit,L.submission),I.on(L.keyup,L.release),_.on(L.reset,L.destroy),y=!0}function f(){y&&(w.off(L.remove,"["+U+"]",L.removal),A.off(L.submit,L.submission),I.off(L.keyup,L.release),_.off(L.reset,L.destroy),y=!1)}function l(t){return r.isNull(t)?!1:(b.push(t),!0)}function g(t){if(r.isFloat(t)||(t=parseFloat(t)),0===t)return null;var e=moment().unix();return{id:S++,value:t,time:e,username:O,iso8601:moment.unix(e).toISOString()}}function p(t){if(r.isInteger(t)||(t=parseInt(t)),0!==t)for(var e=0,n=b.length;n>e;e++){var i=b[e];if(i.id===t){b.splice(e,1);break}}}function d(t){P.handlebars("add",j,t,{remove_type:"same",validate:!r.isEmpty(t)})}function h(t){b=k.get();var e=r.arrayPeek(b);r.isUndefined(e)||(S=e.id),S++,r.isBoolean(t)&&t&&d(b)}function m(t){return r.isString(t)||(t=""+t),t.trim().length>0&&C.test(t)}var N="1.0.0",E="772C021E-61EA-4B15-8330-B2274E891371",v={WEIGHTS:"/weights",WEIGHTS_USERNAME:"/weights/{username}",WEIGHT_USERNAME_ID:"/weights/{id}",USERS:"users"},T=!1,y=!1,b=[],S=0,O=["softwarespot","squidge","brainbox"],w=null,P=null,A=null,I=null,_=null,D=null,R=null,U=null,j=null,C=/^(?!0+)(?:\d+(?:\.\d)?)$/,L={keyup:"keyup.app.weight",remove:"click.remove.app.weight",reset:"click.reset.app.weight",submit:"submit.app.weight",destroy:function(){NProgress.done(),R.addClass("hide"),k.clear(),d(b)},release:function(t){t.preventDefault();var e=t.currentTarget.value;return m(e)?(D.prop("disabled",!1),i):(D.prop("disabled",!0),i)},removal:function(e){e.preventDefault();var n=e.currentTarget.getAttribute(U),i=r.api.get(v.WEIGHTS_USERNAME,{username:"softwarespot",id:n});i.then(function(t){n=r.isDebug()?n:t.id,p(n),k.set(b),d(b)}),i["catch"](function(){t.alert("Some error occurred with DELETE'in the weight value")})},submission:function(e){e.preventDefault();var n=e.currentTarget[0];D.prop("disabled",!0);var o=n.value;if(!m(o))return R.removeClass("hide"),i;I.val(""),R.addClass("hide");var u=r.api.post(v.WEIGHTS_USERNAME,{username:"softwarespot"});u.then(function(t){t=r.isDebug()?g(o):t,l(t)&&(k.set(b),d(b))}),u["catch"](function(){t.alert("Some error occurred with POST'in the weight value")})}},k={key:E+"_app.weight_list",clear:function(){sessionStorage.removeItem(this.key),r.arrayClear(b)},remove:function(){this.clear()},get:function(){var t=sessionStorage.getItem(this.key);return r.isNull(t)?[]:JSON.parse(t)},set:function(t){r.isArray(t)&&sessionStorage.setItem(this.key,JSON.stringify(t))}};return n(function(){o({data_id:"data-weight-id",dom:{forms:{weight:"#weight-post-form"},weight_list:"#weight-list",weight_list_error:"#weight-list-error"},templates:{weight_list:"#template-weight-list"}})}),{init:o,destroy:u,getVersion:s,isValidWeight:m}}(this,this.document,this.jQuery,App.core);