var App={};App.core=function(t,e,n,r){function i(t){if(!C){var e={};n.extend(e,t),NProgress.configure({minimum:.1,showSpinner:!1}),C=!0}}function o(){C=!1}function u(){return j}function s(){return U}function a(t){if(B(t))for(;t.length>0;)t.pop()}function l(t){return B(t)&&0!==t.length?t[t.length-1]:r}function c(t,e){return L.call(t,e)}function f(t){return t===!0||t===!1||S(t)&&k.call(t)===D.BOOLEAN}function m(t){if(T(t))return!0;if(B(t)||O(t))return 0===t.length;for(var e in t)if(c(t,e))return!1;return!0}function p(t){return y(t)&&M.FLOAT.test(""+t)}function d(t){return b(t)&&k.call(t)===D.FUNCTION}function g(t){return y(t)&&M.INTEGER.test(""+t)}function N(t){return t instanceof n}function h(t){return N(t)&&0!==t.length}function E(t){return null!==t}function v(t){return null===t}function T(t){return v(t)||P(t)}function y(t){return"number"==typeof t||S(t)&&k.call(t)===D.NUMBER}function b(t){var e=typeof t;return!!t&&("object"===e||"function"===e)}function S(t){return!!t&&"object"==typeof t}function w(t){return S(t)?t.constructor&&!c(t.constructor.prototype,"isPrototypeOf")?!1:!0:!1}function O(t){return"string"==typeof t||k.call(t)===D.STRING}function A(t){return O(t)&&M.FLOAT.test(t)}function I(t){return O(t)&&M.INTEGER.test(t)}function _(t){return O(t)&&(M.FLOAT.test(t)||M.INTEGER.test(t))}function P(t){return t===r}function R(t,e){return y(t)&&y(e)?Math.floor(Math.random()*e+t):0}var U="1.0.0",j="SoftwareSpot",C=!1,D={BOOLEAN:"[object Boolean]",FUNCTION:"[object Function]",NUMBER:"[object Number]",STRING:"[object String]"},F=Object.prototype,L=F.hasOwnProperty,k=F.toString,M={FLOAT:/(?:^-?\d+\.\d+$)/,INTEGER:/(?:^-?\d+$)/},B=Array.isArray;return n(function(){i({})}),{init:i,destroy:o,getAppName:u,getVersion:s,arrayClear:a,arrayPeek:l,has:c,isArray:B,isBoolean:f,isEmpty:m,isFloat:p,isFunction:d,isInteger:g,isjQuery:N,isjQueryNotEmpty:h,isNotNull:E,isNull:v,isNullOrUndefined:T,isNumber:y,isObject:b,isObjectLiteral:w,isString:O,isStringFloat:A,isStringInteger:I,isStringNumber:_,isUndefined:P,randomNumber:R}}(this,this.document,this.jQuery),App.core.api=function(t,e,n,r){function i(t){if(!h){var e={};n.extend(e,t),s(),a(),h=!0}}function o(){E=null,h=!1}function u(){return g}function s(){E=n(e)}function a(){NProgress.configure({minimum:.1,showSpinner:!1}),E.ajaxStart(function(){NProgress.start()}),E.ajaxStop(function(){NProgress.done()})}function l(){NProgress.start(),t.setTimeout(NProgress.done,750)}function c(e,n){return new Promise(function(i,o){e=d(e,n),r.isNull(e)&&o(),NProgress.start(),t.setTimeout(function(){NProgress.done(),0===r.randomNumber(0,1e3)?o():i()},750)})}function f(e,n){return new Promise(function(i,o){e=d(e,n),r.isNull(e)&&o(),NProgress.start(),t.setTimeout(function(){NProgress.done(),0===r.randomNumber(0,1e3)?o():i()},750)})}function m(e,n){return new Promise(function(i,o){e=d(e,n),r.isNull(e)&&o(),NProgress.start(),t.setTimeout(function(){NProgress.done(),0===r.randomNumber(0,1e3)?o():i()},750)})}function p(e,n){return new Promise(function(i,o){e=d(e,n),r.isNull(e)&&o(),NProgress.start(),t.setTimeout(function(){NProgress.done(),0===r.randomNumber(0,1e3)?o():i()},750)})}function d(t,e){if(!r.isString(t)||!r.isObjectLiteral(e))return null;for(var n=""+t,i=/{([^\}]+)}/g;;){var o=i.exec(n);if(r.isNull(o))break;var u=o[1];if(r.has(e,u)&&!r.isUndefined(e[u])){var s=o[0];t=t.replace(s,e[u])}}return t}var g="1.0.0",N={OK:200,CREATED:201,NO_CONTENT:204,NOT_MODIFIED:304,BAD_REQUEST:400,UNAUTHORIZED:401,FORBIDDEN:403,NOT_FOUND:404,METHOD_NOT_ALLOWED:405,NOT_ACCEPTABLE:406,CONFLICT:409,INTERNAL_SERVER_ERROR:500,NOT_IMPLEMENTED:501},h=!1,E=null;return n(function(){i({})}),{init:i,destroy:o,getVersion:u,HTTPStatus:N,fetch:l,"delete":c,get:f,put:m,post:p,parseUrl:d}}(this,this.document,this.jQuery,App.core),App.weight=function(t,e,n,r,i){function o(t){if(!v){var e={};n.extend(e,t),U=t.data_id,j=t.templates.weight_list,a(t.dom),l(),P.prop("disabled",!0),R.addClass("hide"),S=S[r.randomNumber(0,S.length-1)];var i=r.api.get(E.WEIGHTS_USERNAME,{username:"softwarespot"});i.then(function(){d();for(var t=0,e=r.randomNumber(5,20);e>t;t++)f(1*r.randomNumber(45,200));F.set(y),d(!0)}),i["catch"](function(){d(!0)}),v=!0}}function u(){c(),w=null,O=null,A=null,A=null,_=null,P=null,R=null,r.arrayClear(y),v=!1}function s(){return N}function a(t){w=n(e),O=n(t.weight_list),A=n(t.forms.weight),I=A.find('input[type="text"]'),_=A.find('[type="reset"]'),P=A.find('input[type="submit"]'),R=n(t.weight_list_error)}function l(){T&&c(),w.on(D.remove,"["+U+"]",D.removal),A.on(D.submit,D.submission),I.on(D.keyup,D.release),_.on(D.reset,D.destroy),T=!0}function c(){T&&(w.off(D.remove,"["+U+"]",D.removal),A.off(D.submit,D.submission),I.off(D.keyup,D.release),_.off(D.reset,D.destroy),T=!1)}function f(t){r.isFloat(t)||(t=parseFloat(t));var e=moment().unix();y.push({id:b++,value:t,time:e,username:S,iso8601:moment.unix(e).toISOString()})}function m(t){r.isInteger(t)||(t=parseInt(t));for(var e=0,n=y.length;n>e;e++){var i=y[e];if(i.id===t){y.splice(e,1);break}}}function p(t){O.handlebars("add",j,t,{remove_type:"same",validate:!r.isEmpty(t)})}function d(t){y=F.get();var e=r.arrayPeek(y);r.isUndefined(e)||(b=e.id),b++,r.isBoolean(t)&&t&&p(y)}function g(t){return r.isString(t)||(t=""+t),t.trim().length>0&&C.test(t)}var N="1.0.0",h="772C021E-61EA-4B15-8330-B2274E891371",E={WEIGHTS:"/weights",WEIGHTS_USERNAME:"/weights/{username}",WEIGHT_USERNAME_ID:"/weights/{username}/{id}"},v=!1,T=!1,y=[],b=0,S=["softwarespot","squidge","brainbox"],w=null,O=null,A=null,I=null,_=null,P=null,R=null,U=null,j=null,C=/^(?!0+)(?:\d+(?:\.\d)?)$/,D={keyup:"keyup.app.weight",remove:"click.remove.app.weight",reset:"click.reset.app.weight",submit:"submit.app.weight",destroy:function(){NProgress.done(),R.addClass("hide"),F.clear(),p(y)},release:function(t){t.preventDefault();var e=t.currentTarget.value;return g(e)?(P.prop("disabled",!1),i):(P.prop("disabled",!0),i)},removal:function(e){e.preventDefault();var n=e.currentTarget.getAttribute(U),i=r.api.get(E.WEIGHTS_USERNAME,{username:"softwarespot",id:n});i.then(function(){m(n),F.set(y),p(y)}),i["catch"](function(){t.alert("Some error occurred with DELETE'in the weight value")})},submission:function(e){e.preventDefault();var n=e.currentTarget[0];P.prop("disabled",!0);var o=n.value;if(!g(o))return R.removeClass("hide"),i;I.val(""),R.addClass("hide");var u=r.api.post(E.WEIGHTS_USERNAME,{username:"softwarespot"});u.then(function(){f(o),F.set(y),p(y)}),u["catch"](function(){t.alert("Some error occurred with POST'in the weight value")})}},F={key:h+"_app.weight_list",clear:function(){sessionStorage.removeItem(this.key),r.arrayClear(y)},remove:function(){this.clear()},get:function(){var t=sessionStorage.getItem(this.key);return r.isNull(t)?[]:JSON.parse(t)},set:function(t){r.isArray(t)&&sessionStorage.setItem(this.key,JSON.stringify(t))}};return n(function(){o({data_id:"data-weight-id",dom:{forms:{weight:"#weight-post-form"},weight_list:"#weight-list",weight_list_error:"#weight-list-error"},templates:{weight_list:"#template-weight-list"}})}),{init:o,destroy:u,getVersion:s,isValidWeight:g}}(this,this.document,this.jQuery,App.core);