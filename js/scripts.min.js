var App={};App.core=function(t,n,e,r){function i(){D||(NProgress.configure({minimum:.1,showSpinner:!1}),D=!0)}function o(){D=!1}function u(){return j}function s(){return U}function c(){return B}function a(t){p(t)&&(B=t)}function f(t){if(H(t))for(;t.length>0;)t.pop()}function l(t){return H(t)&&0!==t.length?t[t.length-1]:r}function g(t,n){return G.call(t,n)}function p(t){return t===!0||t===!1||b(t)&&M.call(t)===k.BOOLEAN}function h(t){if(I(t))return!0;if(H(t)||w(t))return 0===t.length;for(var n in t)if(g(t,n))return!1;return!0}function d(t){return O(t)&&x.FLOAT.test(""+t)}function m(t){var n=A(t)?M.call(t):"";return n===k.FUNCTION||n===k.GENERATOR}function N(t){return O(t)&&x.INTEGER.test(""+t)}function E(t){return t instanceof e}function v(t){return E(t)&&0!==t.length}function T(t){return null!==t}function y(t){return null===t}function I(t){return y(t)||R(t)}function O(t){return"number"==typeof t||b(t)&&M.call(t)===k.NUMBER}function A(t){var n=typeof t;return!!t&&("object"===n||"function"===n)}function b(t){return!!t&&"object"==typeof t}function S(t){return b(t)?t.constructor&&!g(t.constructor.prototype,"isPrototypeOf")?!1:!0:!1}function w(t){return"string"==typeof t||M.call(t)===k.STRING}function P(t){return w(t)&&x.FLOAT.test(t)}function _(t){return w(t)&&x.INTEGER.test(t)}function F(t){return w(t)&&(x.FLOAT.test(t)||x.INTEGER.test(t))}function R(t){return t===r}function C(t,n){return O(t)&&O(n)?Math.floor(Math.random()*n+t):0}var U="1.0.0",j="SoftwareSpot",D=!1,k={BOOLEAN:"[object Boolean]",FUNCTION:"[object Function]",GENERATOR:"[object GeneratorFunction]",NUMBER:"[object Number]",STRING:"[object String]"},L=Object.prototype,G=L.hasOwnProperty,M=L.toString,x={FLOAT:/(?:^-?\d+\.\d+$)/,INTEGER:/(?:^-?\d+$)/},B=!1,H=Array.isArray;return e(function(){i()}),{init:i,destroy:o,getAppName:u,getVersion:s,isDebug:c,setIsDebug:a,arrayClear:f,arrayPeek:l,has:g,isArray:H,isBoolean:p,isEmpty:h,isFloat:d,isFunction:m,isInteger:N,isjQuery:E,isjQueryNotEmpty:v,isNotNull:T,isNull:y,isNullOrUndefined:I,isNumber:O,isObject:A,isObjectLiteral:S,isString:w,isStringFloat:P,isStringInteger:_,isStringNumber:F,isUndefined:R,randomNumber:C}}(this,this.document,this.jQuery),App.core.api=function(t,n,e,r){function i(){I||(s(),c(),I=!0)}function o(){O=null,I=!1}function u(){return E}function s(){O=e(n)}function c(){NProgress.configure({minimum:.1,showSpinner:!1}),O.ajaxStart(function(){NProgress.start()}),O.ajaxStop(function(){NProgress.done()})}function a(t){if(t.status>=y.OK&&t.status<y.MULTIPLE_CHOICES)return t;var n=Error(t.statusText);throw n.response=t,n}function f(t){var n=t.json();return n?n:null}function l(n,e,i,o){return new Promise(function(u,s){if(n=N(n,i),r.isDebug())r.isNull(n)&&s(),t.setTimeout(function(){0===r.randomNumber(0,1e3)?s():u()},v);else{var c={method:e,headers:{Accept:"application/json","Content-Type":"application/json"}},l=e===T.PUT||e===T.POST;l&&(t.console.log("fetch() body...",o),c.body=t.JSON.stringify(o)),t.console.log("fetch() in progress...",n,c);var g=t.fetch(n,c);g.then(a),l&&g.then(f),g.then(function(t){u(t)}),g["catch"](function(){s()})}})}function g(){NProgress.start(),t.setTimeout(NProgress.done,v)}function p(t,n){return new Promise(function(e,r){NProgress.start(),l(t,T.DELETE,n).then(function(t){NProgress.done(),e(t)})["catch"](function(t){NProgress.done(),r(t)})})}function h(t,n){return new Promise(function(e,r){NProgress.start(),l(t,T.GET,n).then(function(t){NProgress.done(),e(t)})["catch"](function(t){NProgress.done(),r(t)})})}function d(t,n,e){return new Promise(function(r,i){NProgress.start(),l(t,T.PUT,n,e).then(function(t){NProgress.done(),r(t)})["catch"](function(t){NProgress.done(),i(t)})})}function m(t,n,e){return new Promise(function(r,i){NProgress.start(),l(t,T.POST,n,e).then(function(t){NProgress.done(),r(t)})["catch"](function(t){NProgress.done(),i(t)})})}function N(t,n){if(!r.isString(t)||!r.isObjectLiteral(n))return null;for(var e=""+t,i=/{([^\}]+)}/g;;){var o=i.exec(e);if(r.isNull(o))break;var u=o[1];if(r.has(n,u)&&!r.isUndefined(n[u])){var s=o[0];t=t.replace(s,n[u])}}return t}var E="1.0.0",v=750,T={DELETE:"delete",GET:"get",POST:"post",PUT:"put"},y={OK:200,CREATED:201,NO_CONTENT:204,MULTIPLE_CHOICES:300,NOT_MODIFIED:304,BAD_REQUEST:400,UNAUTHORIZED:401,FORBIDDEN:403,NOT_FOUND:404,METHOD_NOT_ALLOWED:405,NOT_ACCEPTABLE:406,CONFLICT:409,INTERNAL_SERVER_ERROR:500,NOT_IMPLEMENTED:501},I=!1,O=null;return e(function(){i({})}),{init:i,destroy:o,getVersion:u,Methods:T,HTTPStatus:y,fetch:g,"delete":p,get:h,put:d,post:m,parseUrl:N}}(this,this.document,this.jQuery,App.core),App.core.emitter=function(t,n,e,r){function i(){return l}function o(t){return r.isString(t)&&t.trim().length>0}function u(t){return r.isArray(t)&&t.length>0}function s(){g={}}function c(t){if(o(t)){var n=g[t];if(u(n)){for(var e=[],r=1,i=arguments.length;i>r;r++)e.push(arguments[r]);n.forEach(function(t){t.apply(this,e)})}}}function a(t,n){if(o(t)&&r.isFunction(n)){var e=g[t];if(u(e)){var i=e.indexOf(n);-1!==i&&e.splice(i,1)}}}function f(t,n){if(o(t)&&r.isFunction(n)){g[t]=g[t]||[];var e=g[t];-1===e.indexOf(n)&&e.push(n)}}var l="1.0.0",g={};return{getVersion:i,clear:s,emit:c,off:a,on:f}}(this,this.document,this.jQuery,App.core),App.core.events={NAVIGATION_CLICK:"click.navigation.app"},App.navigation=function(t,n,e,r){function i(){a(),s(),p=!0}function o(){c(),h=null,d=null,p=!1}function u(){return l}function s(){g&&c(),d.on(m.click,m.navigation),g=!0}function c(){g&&(d.off(m.click,m.navigation),g=!1)}function a(){h=e("html, body"),d=e("header").find("a")}function f(t,n){r.isUndefined(n)&&(n=500),h.animate({scrollTop:t.offset().top},n)}var l="1.0.0",g=!1,p=!1,h=null,d=null,m={click:"click.app.navigation",navigation:function(t){var n=t.currentTarget.getAttribute("href"),i="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",o=RegExp("^#"+i+"$");if(r.emitter.emit(r.events.NAVIGATION_CLICK,n),!o.test(n))return!0;t.preventDefault();var u=e(n);return 0===u.length?!1:(f(u,500),!1)}};return e(function(){i()}),{init:i,destroy:o,getVersion:u}}(this,this.document,this.jQuery,this.App.core),App.user=function(t,n,e,r){function i(){g||(a(),s(),g=!0)}function o(){g=!1}function u(){return f}function s(){l&&c(),r.emitter.on(p.signIn,p.signInFn),l=!0}function c(){l&&(r.emitter.off(p.signInEvent,p.signIn),l=!1)}function a(){}var f="1.0.0",l=!1,g=!1,p={signIn:r.events.NAVIGATION_CLICK,signInFn:function(n){"#signin-section"===n&&t.console.log("Sign in was called, but nothing took place as of yet")}};return e(function(){i()}),{init:i,destroy:o,getVersion:u}}(this,this.document,this.jQuery,App.core),App.weight=function(t,n,e,r,i){function o(t){if(!y){var n={};e.extend(n,t),C=t.data_id,U=t.templates.weight_list,f(t.dom),c(),F.prop("disabled",!0),R.addClass("hide"),A=A[r.randomNumber(0,A.length-1)];var i=r.api.get(v.WEIGHTS_USERNAME,{username:"softwarespot"});i.then(function(t){if(d(),r.isDebug())for(var n=0,e=r.randomNumber(5,20);e>n;n++)l(g(1*r.randomNumber(45,200)));else t.forEach(function(t){l(t)});k.set(I),d(!0)}),i["catch"](function(){d(!0)}),y=!0}}function u(){a(),b=null,S=null,w=null,w=null,_=null,F=null,R=null,r.arrayClear(I),y=!1}function s(){return N}function c(){T&&a(),b.on(D.remove,"["+C+"]",D.removeFn),w.on(D.submit,D.submitFn),P.on(D.keyup,D.keyupFn),_.on(D.reset,D.resetFn),T=!0}function a(){T&&(b.off(D.remove,"["+C+"]",D.removeFn),w.off(D.submit,D.submitFn),P.off(D.keyup,D.keyupFn),_.off(D.reset,D.resetFn),T=!1)}function f(t){b=e(n),S=e(t.weight_list),w=e(t.forms.weight),P=w.find('input[type="text"]'),_=w.find('[type="reset"]'),F=w.find('input[type="submit"]'),R=e(t.weight_list_error)}function l(t){return r.isNull(t)?!1:(I.push(t),!0)}function g(t){if(r.isFloat(t)||(t=parseFloat(t)),0===t)return null;var n=moment().unix();return{id:O++,value:t,time:n,username:A,iso8601:moment.unix(n).toISOString()}}function p(t){if(r.isInteger(t)||(t=parseInt(t)),0!==t)for(var n=0,e=I.length;e>n;n++){var i=I[n];if(i.id===t){I.splice(n,1);break}}}function h(t){S.handlebars("add",U,t,{remove_type:"same",validate:!r.isEmpty(t)})}function d(t){I=k.get();var n=r.arrayPeek(I);r.isUndefined(n)||(O=n.id),O++,r.isBoolean(t)&&t&&h(I)}function m(t){return r.isString(t)||(t=""+t),t.trim().length>0&&j.test(t)}var N="1.0.0",E="772C021E-61EA-4B15-8330-B2274E891371",v={WEIGHTS:"/weights",WEIGHTS_USERNAME:"/weights/{username}",WEIGHT_USERNAME_ID:"/weights/{id}",USERS:"users"},T=!1,y=!1,I=[],O=0,A=["softwarespot","squidge","brainbox"],b=null,S=null,w=null,P=null,_=null,F=null,R=null,C=null,U=null,j=/^(?!0+)(?:\d+(?:\.\d)?)$/,D={keyup:"keyup.app.weight",remove:"click.remove.app.weight",reset:"click.reset.app.weight",submit:"submit.app.weight",keyupFn:function(t){t.preventDefault();var n=t.currentTarget.value;return m(n)?(F.prop("disabled",!1),i):(F.prop("disabled",!0),i)},resetFn:function(){NProgress.done(),R.addClass("hide"),k.clear(),r.arrayClear(I),h(I)},removeFn:function(n){n.preventDefault();var e=n.currentTarget.getAttribute(C),i=r.api.get(v.WEIGHTS_USERNAME,{username:"softwarespot",id:e});i.then(function(t){e=r.isDebug()?e:t.id,p(e),k.set(I),h(I)}),i["catch"](function(){t.alert("Some error occurred with DELETE'in the weight value")})},submitFn:function(n){n.preventDefault();var e=n.currentTarget[0];F.prop("disabled",!0);var o=e.value;if(!m(o))return R.removeClass("hide"),i;P.val(""),R.addClass("hide");var u=r.api.post(v.WEIGHTS_USERNAME,{username:"softwarespot"});u.then(function(t){t=r.isDebug()?g(o):t,l(t)&&(k.set(I),h(I))}),u["catch"](function(){t.alert("Some error occurred with POST'in the weight value")})}},k={key:E+"_app.weight_list",_has:null,clear:function(){try{t.sessionStorage.removeItem(this.key)}catch(n){t.console.log("An error occurred with _session.clear()")}},has:function(){if(this._has)return this._has();var n=t.sessionStorage;return r.isObject(n)&&"key"in n&&"getItem"in n&&"setItem"in n&&"removeItem"in n&&"clear"in n},remove:this.clear,get:function(){var n=null;try{n=t.sessionStorage.getItem(this.key)}catch(e){t.console.log("An error occurred with _session.get()")}return r.isNullOrUndefined(n)?[]:JSON.parse(n)},set:function(n){if(r.isArray(n))try{t.sessionStorage.setItem(this.key,JSON.stringify(n))}catch(e){t.console.log("An error occurred with _session.set()")}}};return e(function(){o({data_id:"data-weight-id",dom:{forms:{weight:"#weight-post-form"},weight_list:"#weight-list",weight_list_error:"#weight-list-error"},templates:{weight_list:"#template-weight-list"}})}),{init:o,destroy:u,getVersion:s,isValidWeight:m}}(this,this.document,this.jQuery,App.core);