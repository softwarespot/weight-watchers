var App={};App.core=function(t,n,e,r){function i(){H||(t.NProgress.configure({minimum:.1,showSpinner:!1}),H=!0)}function o(){H=!1}function s(){return G}function u(){return B}function c(){return K}function a(t){m(t)&&(K=t)}function l(t){if(J(t))for(;t.length>0;)t.pop()}function f(t){return b(t)?t.replace($.REGEXP_ESCAPE,"\\$1"):null}function p(t){return J(t)&&0!==t.length?t[t.length-1]:r}function g(t,n){return Q.call(t,n)}function h(t){var n=O(t)?W.call(t):M;return n===V.FUNCTION||n===V.GENERATOR}function m(t){return t===!0||t===!1||F(t)&&W.call(t)===V.BOOLEAN}function d(t){if(A(t)||0===t)return!0;if(J(t)||b(t))return 0===t.length;for(var n in t)if(g(t,n))return!1;return!0}function E(t){return I(t)&&$.FLOAT.test(k(t))}function v(t){return I(t)&&$.INTEGER.test(k(t))}function N(t){return t instanceof e}function y(t){return N(t)&&0!==t.length}function S(t){return null!==t}function T(t){return null===t}function A(t){return T(t)||R(t)}function I(t){return"number"==typeof t||F(t)&&W.call(t)===V.NUMBER}function O(t){var n=typeof t;return!!t&&("object"===n||"function"===n)}function F(t){return!!t&&"object"==typeof t}function _(t){return F(t)?t.constructor&&!g(t.constructor.prototype,"isPrototypeOf")?!1:!0:!1}function b(t){return"string"==typeof t||W.call(t)===V.STRING}function w(t){return b(t)&&$.FLOAT.test(t)}function P(t){return b(t)&&$.INTEGER.test(t)}function C(t){return b(t)&&($.FLOAT.test(t)||$.INTEGER.test(t))}function R(t){return t===r}function L(n,e){return I(n)&&I(e)?t.Math.floor(t.Math.random()*e+n):0}function D(n,e){return n=k(n),h(t.String.prototype.includes)?t.String.prototype.includes.call(n,e):-1!==n.indexOf(e)}function U(n){for(var e=[],r=1,i=arguments.length;i>r;r++)e.push(arguments[r]);return n=k(n),e.forEach(function(e,r){var i=new t.RegExp("\\{"+r+"\\}","gi");n=n.replace(i,e)}),n}function j(n){return b(n)?h(t.String.prototype.trim)?t.String.prototype.trim.call(n):n.replace($.TRIM,M):M}function k(t){return b(t)?t:A(t)?M:M+t}function x(n,e){return n=k(n),0===n.length?n:A(e)?j(n):(e="["+f(k(e))+"]",n.replace(new t.RegExp("^"+e+"+|"+e+"+$","g"),M))}var B="1.0.0",G="SoftwareSpot",M="",H=!1,V={BOOLEAN:"[object Boolean]",FUNCTION:"[object Function]",GENERATOR:"[object GeneratorFunction]",NUMBER:"[object Number]",STRING:"[object String]"},Y=t.Object.prototype,Q=Y.hasOwnProperty,W=Y.toString,$={FLOAT:/(?:^(?!-?0+)-?\d+\.\d+$)/,INTEGER:/(?:^(?!-?0+)-?\d+$)/,TRIM:/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g},K=!1,J=h(t.Array.isArray)?t.Array.isArray:function(t){return W.call(t)===V.ARRAY};return e(function(){i()}),{init:i,destroy:o,getAppName:s,getVersion:u,isDebug:c,setIsDebug:a,arrayClear:l,arrayPeek:p,escapeRegExChars:f,has:g,isArray:J,isBoolean:m,isEmpty:d,isFloat:E,isFunction:h,isInteger:v,isjQuery:N,isjQueryNotEmpty:y,isNotNull:S,isNull:T,isNullOrUndefined:A,isNumber:I,isObject:O,isObjectLiteral:_,isString:b,isStringFloat:w,isStringInteger:P,isStringNumber:C,isUndefined:R,randomNumber:L,stringContains:D,stringFormat:U,stringStripWS:j,toString:k,trim:x}}(this,this.document,this.jQuery),App.core.api=function(t,n,e,r,i){function o(){F||(c(),a(),F=!0)}function s(){_=null,F=!1}function u(){return T}function c(){_=e(n)}function a(){t.NProgress.configure({minimum:.1,showSpinner:!1}),_.ajaxStart(function(){t.NProgress.start()}),_.ajaxStop(function(){t.NProgress.done()})}function l(n){if(n.status>=O.OK&&n.status<O.MULTIPLE_CHOICES)return n;var e=new t.Error(n.statusText);throw e.response=n,e}function f(t){var n=t.json();return n?n:t}function p(n,e,i,o){return new t.Promise(function(s,u){if(n=v(n,i),n=N()+S(n),r.isDebug())t.setTimeout(function(){0===r.randomNumber(0,1e3)?u():s()},A);else{var c={method:e,headers:{Accept:"application/json","Content-Type":"application/json"}},a=e===I.PUT||e===I.POST;a&&(t.console.log("fetch() body...",o),c.body=t.JSON.stringify(o)),t.console.log("fetch() in progress...",n,c),t.fetch(n,c).then(l).then(f).then(function(t){s(t)})["catch"](function(){u()})}})}function g(){t.NProgress.start(),t.setTimeout(t.NProgress.done,A)}function h(n,e){return new t.Promise(function(r,i){t.NProgress.start(),p(n,I.DELETE,e).then(function(n){t.NProgress.done(),r(n)})["catch"](function(n){t.NProgress.done(),i(n)})})}function m(n,e){return new t.Promise(function(r,i){t.NProgress.start(),p(n,I.GET,e).then(function(n){t.NProgress.done(),r(n)})["catch"](function(n){t.NProgress.done(),i(n)})})}function d(n,e,r){return new t.Promise(function(i,o){t.NProgress.start(),p(n,I.PUT,e,r).then(function(n){t.NProgress.done(),i(n)})["catch"](function(n){t.NProgress.done(),o(n)})})}function E(n,e,r){return new t.Promise(function(i,o){t.NProgress.start(),p(n,I.POST,e,r).then(function(n){t.NProgress.done(),i(n)})["catch"](function(n){t.NProgress.done(),o(n)})})}function v(t,n){if(!r.isString(t)||!r.isObjectLiteral(n))return t;for(var e=r.toString(t),i=/{([^\}]+)}/g;;){var o=i.exec(e);if(r.isNull(o))break;var s=o[1];if(r.has(n,s)&&!r.isUndefined(n[s])){var u=o[0];t=t.replace(u,n[s])}}return t}function N(){return b}function y(t){r.isString(t)&&0!==t.trim().length&&(b=S(t)+"/")}function S(t){return r.isString(t)?r.trim(t,"/"):""}var T="1.0.0",A=750,I={DELETE:"delete",GET:"get",PATCH:"patch",POST:"post",PUT:"put"},O={OK:200,CREATED:201,NO_CONTENT:204,MULTIPLE_CHOICES:300,NOT_MODIFIED:304,BAD_REQUEST:400,UNAUTHORIZED:401,FORBIDDEN:403,NOT_FOUND:404,METHOD_NOT_ALLOWED:405,NOT_ACCEPTABLE:406,CONFLICT:409,INTERNAL_SERVER_ERROR:500,NOT_IMPLEMENTED:501},F=!1,_=null,b="";return e(function(){o({})}),{init:o,destroy:s,getVersion:u,Methods:I,HTTPStatus:O,fetch:g,"delete":h,get:m,put:d,post:E,parseUrl:v,getPrefix:N,setPrefix:y,trimSlashes:S}}(this,this.document,this.jQuery,App.core),App.core.emitter=function(t,n,e,r,i){function o(){return p}function s(){g={}}function u(n){function e(n,e){t.setTimeout(function(){e.apply(n,i)},0)}if(f(n)){var r=g[n];if(l(r)){for(var i=[],o=1,s=arguments.length;s>o;o++)i.push(arguments[o]);r.forEach(function(t){e(this,t)})}}}function c(t,n){if(f(t)&&r.isFunction(n)){var e=g[t];if(l(e)){var i=e.indexOf(n);-1!==i&&e.splice(i,1)}}}function a(t,n){if(f(t)&&r.isFunction(n)){g[t]=g[t]||[];var e=g[t];-1===e.indexOf(n)&&e.push(n)}}function l(t){return r.isArray(t)&&t.length>0}function f(t){return r.isString(t)&&t.trim().length>0}var p="1.0.0",g={};return{getVersion:o,clear:s,emit:u,off:c,on:a}}(this,this.document,this.jQuery,App.core),App.core.events={NAVIGATION_CLICK:"click.navigation.app",USER_SELECT:"change.user.app"},App.core.session=function(t,n){function e(t,e){this._key=n.isString(t)&&0!==t.length?o+t:o,this._has=r(e),this._storage=this._has?e:s}function r(t){return n.isObject(t)&&"key"in t&&"getItem"in t&&"setItem"in t&&"removeItem"in t&&"clear"in t}var i="1.0.0",o="3943925F-EDCC-45E2-B451-8F0178F6BB24",s=t.sessionStorage;return e.prototype={clear:function(){try{this._storage.removeItem(this._key)}catch(n){t.console.log("An error occurred with Session.clear()",n)}},get:function(){var n=null;try{n=this._storage.getItem(this._key)}catch(e){t.console.log("An error occurred with Session.get()",e)}return n},has:function(){return this._has},remove:this.clear,set:function(n){try{this._storage.setItem(this._key,n)}catch(e){t.console.log("An error occurred with Session.set()",e)}},getVersion:function(){return i}},e}(this,App.core),App.navigation=function(t,n,e,r,i){function o(){l(),c(),h=!0}function s(){a(),m=null,d=null,h=!1}function u(){return p}function c(){g&&a(),d.on(E.navigation,E.navigationFn),g=!0}function a(){g&&(d.off(E.navigation,E.navigationFn),g=!1)}function l(){m=e("html, body"),d=e("header").find("a")}function f(t,n){r.isUndefined(n)&&(n=500),m.animate({scrollTop:t.offset().top},n)}var p="1.0.0",g=!1,h=!1,m=null,d=null,E={navigation:r.events.NAVIGATION_CLICK,navigationFn:function(n){var i=n.currentTarget.getAttribute("href"),o="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",s=new t.RegExp("^#"+o+"$");if(r.emitter.emit(r.events.NAVIGATION_CLICK,i),!s.test(i))return!0;n.preventDefault();var u=e(i);return r.isjQueryNotEmpty(u)?(f(u,500),!1):!1}};return e(function(){o()}),{init:o,destroy:s,getVersion:u}}(this,this.document,this.jQuery,this.App.core),App.user=function(t,n,e,r,i){function o(t){if(!d){var n={};e.extend(n,t),N=t.templates.userList,l(t.dom),c(),r.api.setPrefix("api"),S.usersFn(),d=!0}}function s(){a(),E=null,d=!1}function u(){return p}function c(){m&&a(),r.emitter.on(S.signIn,S.signInFn),E.on(S.select,S.selectFn),m=!0}function a(){m&&(r.emitter.off(S.signInEvent,S.signIn),E.off(S.select,S.selectFn),m=!1)}function l(t){E=e(t.userList)}function f(t){var n=E.handlebars("add",N,t,{remove_type:"same",type:"COMPILED",validate:!r.isEmpty(t)});E.append(n)}var p="1.0.0",g="B33D672B-E507-478E-99D1-3B0CA10CD765",h={USERS:"users"},m=!1,d=!1,E=null,v=["softwarespot","squidge","brainbox"],N=null,y=new r.session(g+"_users,app"),S={select:r.events.USER_SELECT,signIn:r.events.NAVIGATION_CLICK,selectFn:function(){var t=event.currentTarget.value;r.isString(t)&&r.emitter.emit(S.select,t)},usersFn:function(){var n=y.get();return r.isNull(n)?(r.api.get(h.USERS).then(function(n){r.isDebug()&&(n=v),y.set(t.JSON.stringify(n)),f({usernames:n})})["catch"](function(){f(null)}),i):(f({usernames:t.JSON.parse(n)}),i)},signInFn:function(n){"#signin-section"===n&&t.console.log("Sign in was called, but nothing took place as of yet")}};return e(function(){o({dom:{userList:'select[name="username"]'},templates:{userList:"#template-user-list"}})}),{init:o,destroy:s,getVersion:u}}(this,this.document,this.jQuery,App.core),App.weight=function(t,n,e,r,i){function o(t){if(!O){var n={};e.extend(n,t),G=t.dataId,M=t.templates.weightList,c(t.dom),a(),x.prop("disabled",!0),B.addClass("hide"),r.api.setPrefix("api"),O=!0}}function s(){l(),L=null,D=null,C=null,U=null,U=null,k=null,x=null,B=null,r.arrayClear(h()),O=!1}function u(){return y}function c(t){L=e(n),D=e(t.weightList),C=e(t.displayAll),U=e(t.forms.weight),j=U.find('input[type="text"]'),k=U.find('[type="reset"]'),x=U.find('input[type="submit"]'),B=e(t.weightListError)}function a(){I&&l(),r.emitter.on(V.select,V.selectFn),L.on(V.remove,"["+G+"]",V.removeFn),C.on(V.checked,V.displayAllFn),U.on(V.submit,V.submitFn),j.on(V.keyup,V.keyupFn),k.on(V.reset,V.resetFn),I=!0}function l(){I&&(r.emitter.off(V.select,V.selectFn),L.off(V.remove,"["+G+"]",V.removeFn),C.off(V.checked,V.displayAllFn),U.off(V.submit,V.submitFn),j.off(V.keyup,V.keyupFn),k.off(V.reset,V.resetFn),I=!1)}function f(t){return t=r.toString(t),!r.isEmpty(t)&&H.test(t)}function p(n){if(r.isNull(n))return!1;var e=t.moment(n.time).format(A);return!P&&_.has(e)?!1:(n.iso8601=t.moment(n.time).toISOString(),_.add(e),F.push(n),!0)}function g(n){if(r.isFloat(n)||(n=t.parseFloat(n)),0===n)return null;var e=0;return t.moment.isMoment(b)?(e=b.valueOf(),b=b.add(1,"days")):e=t.moment().valueOf(),{id:w++,value:n,time:e,username:R}}function h(t){if(!r.isInteger(t)||0>t||t>=F.length)return F;var n=F[t];return r.isUndefined(n)?F:n}function m(n){if(r.isInteger(n)||(n=t.parseInt(n)),0===n)return null;for(var e=0,i=F.length;i>e;e++){var o=F[e];if(o.id===n)return o.username}return null}function d(n){if(r.isInteger(n)||(n=t.parseInt(n)),0!==n)for(var e=0,i=F.length;i>e;e++){var o=F[e];if(o.id===n){F.splice(e,1);break}}}function E(t){D.handlebars("add",M,t,{remove_type:"same",validate:!r.isEmpty(t)})}function v(t){return r.stringContains(t,",")?t.replace(",","."):t}function N(){F=Q.get(),_.clear();var t=r.arrayPeek(F);r.isUndefined(t)||(w=t.id),w++}var y="1.0.0",S="772C021E-61EA-4B15-8330-B2274E891371",T={USERS:"users",WEIGHT_BY_ID:"weights/{id}",WEIGHT_BY_USERNAME_AND_ID:"users/{username}/weights/{id}",WEIGHTS_ALL:"weights",WEIGHTS_BY_USERNAME:"users/{username}/weights"},A="YYYYMMDD",I=!1,O=!1,F=[],_=new t.Set,b=null,w=0,P=!1,C=null,R=null,L=null,D=null,U=null,j=null,k=null,x=null,B=null,G=null,M=null,H=/^(?!0+)(?:\d+(?:[.,]\d)?)$/,V={checked:"change.display_all.weight.app",keyup:"keyup.weight.app",remove:"click.remove.weight.app",reset:"click.reset.weight.app",select:r.events.USER_SELECT,submit:"submit.weight.app",displayAllFn:function(t){var n=t.currentTarget;P=n.checked,r.emitter.emit(V.select,R)},keyupFn:function(t){t.preventDefault();var n=t.currentTarget.value;return f(n)?(x.prop("disabled",!1),i):(x.prop("disabled",!0),i)},resetFn:function(){t.NProgress.done(),B.addClass("hide"),Q.clear(),r.arrayClear(h()),E(h())},removeFn:function(n){n.preventDefault();var e=n.currentTarget.getAttribute(G);r.api["delete"](T.WEIGHT_BY_USERNAME_AND_ID,{id:e,username:m(e)}).then(function(t){e=r.isDebug()?e:t.id,d(e),Q.set(h()),E(h())})["catch"](function(){t.console.log("Some error occurred with DELETE'in the weight value")})},selectFn:function(n){r.isEmpty(n)||(R=n,r.api.get(T.WEIGHTS_BY_USERNAME,{username:R}).then(function(n){if(Q.clear(),N(),r.isDebug()){var e=r.randomNumber(5,20);t.moment.isMoment(b)||(b=t.moment().subtract(e+r.randomNumber(5,200),"days"));for(var i=0;e>i;i++)p(g(1*r.randomNumber(45,200)));b=null}else n.forEach(function(t){p(t)});Q.set(h()),N(),E(h())})["catch"](function(){E(h())}))},submitFn:function(n){n.preventDefault();var e=n.currentTarget[0];x.prop("disabled",!0);var o=e.value;return f(o)?(j.val(""),B.addClass("hide"),o=v(o),r.api.post(T.WEIGHTS_BY_USERNAME,{username:R},{id:0,value:o,time:0,username:R}).then(function(t){t=r.isDebug()?g(o):t,p(t)&&(Q.set(h()),E(h()))})["catch"](function(){t.console.log("Some error occurred with POST'in the weight value")}),i):(B.removeClass("hide"),i)}},Y=new r.session(S+"_weight_list.app"),Q={clear:function(){Y.clear()},has:function(){return Y.has()},remove:this.clear,get:function(){var n=Y.get();return r.isEmpty(n)?[]:t.JSON.parse(n)},set:function(t){r.isArray(t)&&Y.set(t)}};return e(function(){o({dataId:"data-weight-id",dom:{forms:{weight:"#weight-post-form"},displayAll:'[name="display-all"]',weightList:"#weight-list",weightListError:"#weight-list-error"},templates:{weightList:"#template-weight-list"}})}),{init:o,destroy:s,getVersion:u,isValidWeight:f}}(this,this.document,this.jQuery,App.core);