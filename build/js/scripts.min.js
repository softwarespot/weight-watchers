var App={};App.core=function(n,t,e,r){function i(){V||(n.NProgress.configure({minimum:.1,showSpinner:!1}),V=!0)}function o(){V=!1}function u(){return H}function s(){return B}function a(){return yn}function c(n){d(n)&&(yn=n)}function l(n){if(Nn(n)){var t=n.length;t>0&&n.splice(0,t)}}function f(n){if(Nn(n)){var t=n.length;return t>0?n[t-1]:r}}function g(n,t){return fn.call(n,t)}function p(n){var t=gn.call(n);return t===on||t===un}function d(n){return n===!1||n===!0||gn.call(n)===rn}function m(n){if(S(n)||0===n)return!0;if(Nn(n)||F(n))return 0===n.length;for(var t in n)if(g(n,t))return!1;return!0}function h(n){return b(n)&&pn.test(k(n))}function w(n){return b(n)&&dn.test(k(n))}function v(n){return n instanceof e}function E(n){return v(n)&&n.length>0}function y(n){return!N(n)}function N(n){return null===n}function S(n){return N(n)||C(n)}function b(n){return"number"==typeof n||gn.call(n)===sn}function A(n){var t=typeof n;return!!n&&("object"===t||"function"===t)}function T(n){return x(n)?n.constructor&&g(n.constructor.prototype,"isPrototypeOf"):!1}function F(n){return"string"==typeof n||gn.call(n)===cn}function I(n){return F(n)&&pn.test(n)}function _(n){return F(n)&&dn.test(n)}function O(n){return F(n)&&(pn.test(n)||dn.test(n))}function C(n){return n===r}function P(n,t){return b(n)&&b(t)?K(J()*t+n):0}function D(n){return F(n)&&0!==n.length?n.replace(mn,"\\$&"):Y}function L(n,t){return F(n)?p(nn)?nn.call(n,t):n.indexOf(t)!==G:!1}function j(n){if(!F(n))return Y;var t=1,e=arguments.length;if(0===n.length||t>=e)return n;for(var r=Q(e),i=t,o=0;e>i;)r[o++]=arguments[i++];return n.replace(hn,function(n,t){var e=r[U(t)];return C(e)?n:e})}function U(n){return n=q(n),bn(n)?0:0!==n&&Sn(n)?(n>0?1:-1)*K($(n)):n}function k(n){return F(n)?n:S(n)||T(n)?Y:Y+n}function R(n,t){return F(n)&&0!==n.length?F(t)?(t="["+D(t)+"]",n.replace(new X("^"+t+"+|"+t+"+$","g"),Y)):M(n):Y}function x(n){return gn.call(n)===an}function M(n){return p(tn)?tn.call(n):n.replace(En,Y)}var B="1.0.0",H="SoftwareSpot",G=1,Y="",V=!1,Q=n.Array,W=n.Array.isArray,$=n.Math.abs,K=n.Math.floor,J=n.Math.random,q=n.Number,Z=n.Number.isFinite,z=n.Number.isNaN,X=n.RegExp,nn=n.String.prototype.includes,tn=n.String.prototype.trim,en="[object Array]",rn="[object Boolean]",on="[object Function]",un="[object GeneratorFunction]",sn="[object Number]",an="[object Object]",cn="[object String]",ln=n.Object.prototype,fn=ln.hasOwnProperty,gn=ln.toString,pn=/(?:^-?(?!0{2,})\d+\.\d+$)/,dn=/(?:^-?(?!0+)\d+$)/,mn=/([\].|*?+(){}^$\\:=[])/g,hn=/(?:{(\d+)})/g,wn=/^[\s\uFEFF\xA0]+/,vn=/[\s\uFEFF\xA0]+$/,En=new X(wn.source+"|"+vn.source,"g"),yn=!1,Nn=p(W)?W:function(n){return gn.call(n)===en},Sn=p(Z)?Z:function(t){return b(t)&&n.isFinite(t)},bn=p(z)?z:function(n){return b(n)&&n!==n};return e(function(){i()}),{init:i,destroy:o,getAppName:u,getVersion:s,isDebug:a,setIsDebug:c,arrayClear:l,arrayPeek:f,regExpEscape:D,has:g,isArray:Nn,isBoolean:d,isEmpty:m,isFinite:Sn,isFloat:h,isFunction:p,isInteger:w,isjQuery:v,isjQueryNotEmpty:E,isNaN:bn,isNil:S,isNotNull:y,isNull:N,isNumber:b,isObject:A,isObjectLiteral:T,isString:F,isStringFloat:I,isStringInteger:_,isStringNumber:O,isUndefined:C,randomNumber:P,stringContains:L,stringFormat:j,toInteger:U,toString:k,trim:R}}(window,window.document,window.jQuery),App.core.api=function(n,t,e,r,i){function o(){F||(a(),c(),F=!0)}function u(){I=null,F=!1}function s(){return S}function a(){I=e(t)}function c(){n.NProgress.configure({minimum:.1,showSpinner:!1}),I.ajaxStart(function(){n.NProgress.start()}),I.ajaxStop(function(){n.NProgress.done()})}function l(t){if(t.status>=T.OK&&t.status<T.MULTIPLE_CHOICES)return t;var e=new n.Error(t.statusText);throw e.response=t,e}function f(n){try{return n.json()}catch(t){return n}}function g(t,e,i,o){return new n.Promise(function(u,s){if(t=v(t,i),t=E()+N(t),r.isDebug())n.setTimeout(function(){0===r.randomNumber(0,1e3)?s():u()},r.randomNumber(b,5*b));else{var a={method:e,headers:{Accept:"application/json","Content-Type":"application/json"}},c=e===A.PUT||e===A.POST;c&&(n.console.log("fetch() body...",o),a.body=n.JSON.stringify(o)),n.console.log("fetch() in progress...",t,a),n.fetch(t,a).then(l).then(f).then(function(n){u(n)})["catch"](function(n){s(n)})}})}function p(){n.NProgress.start(),n.setTimeout(n.NProgress.done,b)}function d(t,e){return new n.Promise(function(r,i){n.NProgress.start(),g(t,A.DELETE,e).then(function(t){n.NProgress.done(),r(t)})["catch"](function(t){n.NProgress.done(),i(t)})})}function m(t,e){return new n.Promise(function(r,i){n.NProgress.start(),g(t,A.GET,e).then(function(t){n.NProgress.done(),r(t)})["catch"](function(t){n.NProgress.done(),i(t)})})}function h(t,e,r){return new n.Promise(function(i,o){n.NProgress.start(),g(t,A.PUT,e,r).then(function(t){n.NProgress.done(),i(t)})["catch"](function(t){n.NProgress.done(),o(t)})})}function w(t,e,r){return new n.Promise(function(i,o){n.NProgress.start(),g(t,A.POST,e,r).then(function(t){n.NProgress.done(),i(t)})["catch"](function(t){n.NProgress.done(),o(t)})})}function v(n,t){if(!r.isString(n)||!r.isObjectLiteral(t))return n;var e=/{([^{}]*)}/g;return r.toString(n).replace(e,function(n,e){return r.has(t,e)&&!r.isUndefined(t[e])?t[e]:n})}function E(){return _}function y(n){r.isString(n)&&0!==n.trim().length&&(_=N(n)+"/")}function N(n){return r.isString(n)?r.trim(n,"/"):""}var S="1.0.0",b=250,A={DELETE:"delete",GET:"get",PATCH:"patch",POST:"post",PUT:"put"},T={OK:200,CREATED:201,NO_CONTENT:204,MULTIPLE_CHOICES:300,NOT_MODIFIED:304,BAD_REQUEST:400,UNAUTHORIZED:401,FORBIDDEN:403,NOT_FOUND:404,METHOD_NOT_ALLOWED:405,NOT_ACCEPTABLE:406,CONFLICT:409,INTERNAL_SERVER_ERROR:500,NOT_IMPLEMENTED:501},F=!1,I=null,_="";return e(function(){o({})}),{init:o,destroy:u,getVersion:s,Methods:A,HTTPStatus:T,fetch:p,"delete":d,get:m,put:h,post:w,parseUrl:v,getPrefix:E,setPrefix:y,trimSlashes:N}}(window,window.document,window.jQuery,window.App.core),App.core.emitter=function(n,t,e,r,i){function o(){return w}function u(n){f(n,E),f(n,y)}function s(n){if(d(n)){for(var t=[],e=1,r=arguments.length;r>e;e++)t.push(arguments[e]);g(n,t,E),g(n,t,y),f(n,y)}}function a(n,t){d(n)&&r.isFunction(t)&&(m(n,t,E),m(n,t,y))}function c(n,t){d(n)&&r.isFunction(t)&&h(n,t,E)}function l(n,t){d(n)&&r.isFunction(t)&&h(n,t,y)}function f(n,t){return d(n)?(p(t[n])&&(t[n]=[]),i):(t={},i)}function g(t,e,r){var i=r[t];p(i)&&i.forEach(function(t){n.setTimeout(function(){t.apply(this,e)}.bind(this),0)})}function p(n){return r.isArray(n)&&n.length>0}function d(n){return r.isString(n)&&n.trim().length>0}function m(n,t,e){var r=e[n];if(p(r)){var i=r.indexOf(t);i!==v&&r.splice(i,1)}}function h(n,t,e){e[n]=e[n]||[];var r=e[n];r.indexOf(t)===v&&r.push(t)}var w="1.0.0",v=-1,E={},y={};return{getVersion:o,clear:u,emit:s,off:a,on:c,one:l}}(window,window.document,window.jQuery,window.App.core),App.core.events={NAVIGATION_CLICK:"click.navigation.app",USER_SELECT:"change.user.app"},App.core.session=function(n,t){function e(n,e){this._key=t.isString(n)&&0===n.length?o+n:o,this._storage=e,this._has=r(this._storage),this._has||(this._storage=u,this._has=r(this._storage))}function r(n){return t.isObject(n)&&"key"in n&&"getItem"in n&&"setItem"in n&&"removeItem"in n&&"clear"in n}var i="1.0.0",o="3943925F-EDCC-45E2-B451-8F0178F6BB24",u=n.sessionStorage;return e.prototype={clear:function(){try{this._storage.removeItem(this._key)}catch(t){n.console.log("An error occurred with Session.clear()",t)}},get:function(){var t=null;try{t=this._storage.getItem(this._key)}catch(e){n.console.log("An error occurred with Session.get()",e)}return t},has:function(){return this._has},remove:this.clear,set:function(e){try{t.isEmpty(e)||this._storage.setItem(this._key,e)}catch(r){n.console.log("An error occurred with Session.set()",r)}},getVersion:function(){return i}},e}(window,window.App.core),App.navigation=function(n,t,e,r,i){function o(){l(),a(),d=!0}function u(){c(),m=null,h=null,d=!1}function s(){return g}function a(){p&&c(),h.on(w.navigation,w.navigationFn),p=!0}function c(){p&&(h.off(w.navigation,w.navigationFn),p=!1)}function l(){m=e("html, body"),h=m.find("header").find("a")}function f(n,t){r.isUndefined(t)&&(t=500),m.animate({scrollTop:n.offset().top},t)}var g="1.0.0",p=!1,d=!1,m=null,h=null,w={navigation:r.events.NAVIGATION_CLICK,navigationFn:function(t){var i=t.currentTarget.getAttribute("href"),o="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",u=new n.RegExp("^#"+o+"$");if(r.emitter.emit(r.events.NAVIGATION_CLICK,i),!u.test(i))return!0;t.preventDefault();var s=e(i);return r.isjQueryNotEmpty(s)?(f(s,500),!1):!1}};return e(function(){o()}),{init:o,destroy:u,getVersion:s}}(window,window.document,window.jQuery,window.App.core),App.user=function(n,t,e,r,i){function o(n){if(!h){var t={};e.extend(t,n),E=n.templates.userList,l(n.dom),a(),r.api.setPrefix("api"),N.usersFn(),h=!0}}function u(){c(),w=null,h=!1}function s(){return g}function a(){m&&c(),r.emitter.on(N.signIn,N.signInFn),w.on(N.select,N.selectFn),m=!0}function c(){m&&(r.emitter.off(N.signInEvent,N.signIn),w.off(N.select,N.selectFn),m=!1)}function l(n){var t=e(n.html);w=t.find(n.userList)}function f(n){var t=w.handlebars("add",E,n,{removeType:"same",type:"COMPILED",validate:!r.isEmpty(n)});w.append(t)}var g="1.0.0",p="B33D672B-E507-478E-99D1-3B0CA10CD765",d={USERS:"users"},m=!1,h=!1,w=null,v=["softwarespot","squidge","brainbox"],E=null,y=new r.session(p+"_users.app"),N={select:r.events.USER_SELECT,signIn:r.events.NAVIGATION_CLICK,selectFn:function(){var n=event.currentTarget.value;r.isString(n)&&r.emitter.emit(N.select,n)},usersFn:function(){var t=y.get();return r.isNull(t)?(r.api.get(d.USERS).then(function(t){r.isDebug()&&(t=v),y.set(n.JSON.stringify(t)),f({usernames:t})})["catch"](function(){f(null)}),i):(f({usernames:n.JSON.parse(t)}),i)},signInFn:function(t){"#signin-section"===t&&n.console.log("Sign in was called, but nothing took place as of yet")}};return e(function(){o({dom:{html:"#weight-post-form",userList:'select[name="username"]'},templates:{userList:"#template-user-list"}})}),{init:o,destroy:u,getVersion:s}}(window,window.document,window.jQuery,window.App.core),App.weight=function(n,t,e,r,i){function o(n){if(!I){var t={};e.extend(t,n),Q=n.dataId,W=n.templates.weightList,a(n.dom),c(),B.prop("disabled",!0),V.addClass("hide"),r.api.setPrefix("api"),E(),I=!0}}function u(){l(),U=null,k=null,L=null,R=null,x=null,M=null,B=null,V=null,H=null,r.arrayClear(d()),I=!1}function s(){return S}function a(n){var r=e(n.html);k=r.find(n.weightList),L=r.find(n.displayAll),R=r.find(n.forms.weight),x=R.find('input[type="text"]'),M=R.find('[type="reset"]'),B=R.find('input[type="submit"]'),V=r.find(n.weightListError),H=r.find(n.weightChart),U=e(t)}function c(){F&&l(),r.emitter.on(K.select,K.selectFn),U.on(K.remove,"["+Q+"]",K.removeFn),L.on(K.checked,K.displayAllFn),R.on(K.submit,K.submitFn),x.on(K.keyup,K.keyupFn),M.on(K.reset,K.resetFn),F=!0}function l(){F&&(r.emitter.off(K.select,K.selectFn),U.off(K.remove,"["+Q+"]",K.removeFn),L.off(K.checked,K.displayAllFn),R.off(K.submit,K.submitFn),x.off(K.keyup,K.keyupFn),M.off(K.reset,K.resetFn),F=!1)}function f(n){return n=r.toString(n),!r.isEmpty(n)&&$.test(n)}function g(t){if(r.isNull(t))return!1;var e=n.moment(t.time),i=e.format(T);return!D&&O.has(i)?!1:(t.moment=e,t.iso8601=t.moment.toISOString(),O.add(i),_.push(t),!0)}function p(t){if(r.isFloat(t)||(t=n.parseFloat(t)),0===t)return null;var e=0;return n.moment.isMoment(C)?(e=C.valueOf(),C=C.add(1,"days")):e=n.moment().valueOf(),{id:P++,value:t,time:e,username:j}}function d(n){if(!r.isInteger(n)||0>n||n>=_.length)return _;var t=_[n];return r.isUndefined(t)?_:t}function m(t){if(r.isInteger(t)||(t=n.parseInt(t)),0===t)return null;for(var e=0,i=_.length;i>e;e++){var o=_[e];if(o.id===t)return o.username}return null}function h(t){if(r.isInteger(t)||(t=n.parseInt(t)),0!==t)for(var e=0,i=_.length;i>e;e++){var o=_[e];if(o.id===t){_.splice(e,1);break}}}function w(){r.isArray(_)&&0!==_.length&&_.sort(function(n,t){return n.time<t.time?-1:n.time>t.time?1:0})}function v(n){k.handlebars("add",W,n,{removeType:"same",validate:!r.isEmpty(n)})}function E(t){if(!r.isArray(t)||0===t.length)return H.hide(),i;H.show(),r.isNull(G)?G=new n.Chart(H.get(0).getContext("2d")):Y.destroy();var e="YYYY/MM/DD",o=new n.Set,u=[];t.forEach(function(t){var r=n.moment(t.moment).format(e);o.has(r)||(o.add(r),u.push(t.value))});var s={labels:n.Array.from(o),datasets:[{label:"Weight values",fillColor:"rgba(220,220,220,0.2)",strokeColor:"rgba(220,220,220,1)",pointColor:"rgba(220,220,220,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:u}]};Y=G.Line(s)}function y(n){return r.stringContains(n,",")?n.replace(",","."):n}function N(){_=q.get(),O.clear();var n=r.arrayPeek(_);r.isUndefined(n)||(P=n.id),P++}var S="1.0.0",b="772C021E-61EA-4B15-8330-B2274E891371",A={USERS:"users",WEIGHT_BY_ID:"weights/{id}",WEIGHT_BY_USERNAME_AND_ID:"users/{username}/weights/{id}",WEIGHTS_ALL:"weights",WEIGHTS_BY_USERNAME:"users/{username}/weights"},T="YYYYMMDD",F=!1,I=!1,_=[],O=new n.Set,C=null,P=0,D=!1,L=null,j=null,U=null,k=null,R=null,x=null,M=null,B=null,H=null,G=null,Y=null,V=null,Q=null,W=null,$=/^(?!0+)(?:\d+(?:[.,]\d)?)$/,K={checked:"change.display_all.weight.app",keyup:"keyup.weight.app",remove:"click.remove.weight.app",reset:"click.reset.weight.app",select:r.events.USER_SELECT,submit:"submit.weight.app",displayAllFn:function(n){var t=n.currentTarget;D=t.checked,r.emitter.emit(K.select,j)},keyupFn:function(n){n.preventDefault();var t=n.currentTarget.value;return f(t)?(B.prop("disabled",!1),i):(B.prop("disabled",!0),i)},resetFn:function(){n.NProgress.done(),j=null,V.addClass("hide"),q.clear(),r.arrayClear(d()),v(d()),E(d())},removeFn:function(t){t.preventDefault();var e=t.currentTarget.getAttribute(Q);r.api["delete"](A.WEIGHT_BY_USERNAME_AND_ID,{id:e,username:m(e)}).then(function(){h(e),q.set(d()),v(d()),E(d())})["catch"](function(){n.console.log("Some error occurred with DELETE'in the weight value")})},selectFn:function(t){t=r.isUndefined(t)?j:t,r.isEmpty(t)||(j=t,r.api.get(A.WEIGHTS_BY_USERNAME,{username:j}).then(function(t){if(q.clear(),N(),r.isDebug()){var e=r.randomNumber(5,20);n.moment.isMoment(C)||(C=n.moment().subtract(e+r.randomNumber(5,200),"days"));for(var i=0;e>i;i++)g(p(1*r.randomNumber(45,200)));C=null}else t.forEach(function(n){g(n)});w(),q.set(d()),N(),v(d()),E(d())})["catch"](function(){K.resetFn()}))},submitFn:function(t){t.preventDefault();var e=t.currentTarget[0];B.prop("disabled",!0);var o=e.value;return f(o)?(x.val(""),V.addClass("hide"),o=y(o),r.api.post(A.WEIGHTS_BY_USERNAME,{username:j},{id:0,value:o,time:0,username:j}).then(function(){if(r.isDebug()){var n=p(o);g(n)&&(w(),q.set(d()),v(d()),E(d()))}else K.selectFn()})["catch"](function(){n.console.log("Some error occurred with POST'in the weight value")}),i):(V.removeClass("hide"),i)}},J=new r.session(b+"_weight_list.app"),q={clear:function(){J.clear()},has:function(){return J.has()},remove:this.clear,get:function(){var t=J.get();return r.isEmpty(t)?[]:n.JSON.parse(t)},set:function(t){r.isArray(t)&&J.set(n.JSON.stringify(t))}};return e(function(){o({dataId:"data-weight-id",dom:{html:"#weight-section",forms:{weight:"#weight-post-form"},displayAll:'[name="display-all"]',weightChart:"#weight-chart",weightList:"#weight-list",weightListError:"#weight-list-error"},templates:{weightList:"#template-weight-list"}})}),{init:o,destroy:u,getVersion:s,isValidWeight:f}}(window,window.document,window.jQuery,window.App.core);