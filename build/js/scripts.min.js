var App={};App.core=function(n,t,e){function r(){V||(n.NProgress.configure({minimum:.1,showSpinner:!1}),V=!0)}function i(){V=!1}function o(){return H}function u(){return B}function s(){return Fn}function c(n){d(n)&&(Fn=n)}function a(n){if(In(n)){var t=n.length;t>0&&n.splice(0,t)}}function l(n){if(!In(n))return null;var t=n.length;return t>0?n[t-1]:null}function f(n,t){return on.call(n,t)}function g(n){var t=un.call(n);return t===pn||t===mn}function d(n){return n===!1||n===!0||un.call(n)===dn}function p(n){if(N(n)||0===n)return!0;if(In(n)||T(n))return 0===n.length;for(var t in n)if(f(n,t))return!1;return!0}function m(n){return S(n)&&En.test(U(n))}function h(n){return S(n)&&yn.test(U(n))}function v(n){return n instanceof e}function w(n){return v(n)&&n.length>0}function E(n){return!y(n)}function y(n){return null===n}function N(n){return y(n)||O(n)}function S(n){return"number"==typeof n||un.call(n)===hn}function b(n){var t=typeof n;return!!n&&("object"===t||"function"===t)}function A(n){return x(n)?n.constructor&&f(n.constructor.prototype,"isPrototypeOf"):!1}function T(n){return"string"==typeof n||un.call(n)===wn}function F(n){return T(n)&&En.test(n)}function I(n){return T(n)&&yn.test(n)}function _(n){return T(n)&&(En.test(n)||yn.test(n))}function O(n){return void 0===n}function C(){return g(en)?en(null):{}}function P(n,t){return S(n)&&S(t)?q(Z()*t+n):0}function D(n){return T(n)&&0!==n.length?n.replace(Nn,"\\$&"):Y}function L(n,t){return T(n)?g(ln)?ln.call(n,t):n.indexOf(t)!==G:!1}function j(n){if(!T(n))return Y;var t=1,e=arguments.length;if(0===n.length||t>=e)return n;for(var r=Q(e),i=t,o=0;e>i;)r[o++]=arguments[i++];return n.replace(Sn,function(n,t){var e=r[k(t)];return O(e)?n:e})}function k(n){return n=z(n),On(n)?0:0!==n&&_n(n)?(n>0?1:-1)*q(J(n)):n}function U(n){return T(n)?n:N(n)||A(n)?Y:Y+n}function R(n,t){return T(n)&&0!==n.length?T(t)?(t="["+D(t)+"]",n.replace(new sn("^"+t+"+|"+t+"+$","g"),Y)):M(n):Y}function x(n){return un.call(n)===vn}function M(n){return g(fn)?fn.call(n):n.replace(Tn,Y)}var B="1.0.0",H="SoftwareSpot",G=1,Y="",V=!1,Q=n.Array,W=Q.isArray,$=n.isFinite,K=n.Math,J=K.abs,q=K.floor,Z=K.random,z=n.Number,X=z.isFinite,nn=z.isNaN,tn=n.Object,en=tn.create,rn=tn.prototype,on=rn.hasOwnProperty,un=rn.toString,sn=n.RegExp,cn=n.String,an=cn.prototype,ln=an.includes,fn=an.trim,gn="[object Array]",dn="[object Boolean]",pn="[object Function]",mn="[object GeneratorFunction]",hn="[object Number]",vn="[object Object]",wn="[object String]",En=/(?:^-?(?!0{2,})\d+\.\d+$)/,yn=/(?:^-?(?!0+)\d+$)/,Nn=/([\].|*?+(){}^$\\:=[])/g,Sn=/(?:{(\d+)})/g,bn=/^[\s\uFEFF\xA0]+/,An=/[\s\uFEFF\xA0]+$/,Tn=new sn(bn.source+"|"+An.source,"g"),Fn=!1,In=g(W)?W:function(n){return un.call(n)===gn},_n=g(X)?X:function(n){return S(n)&&$(n)},On=g(nn)?nn:function(n){return S(n)&&n!==n};return e(function(){r()}),{init:r,destroy:i,getAppName:o,getVersion:u,isDebug:s,setIsDebug:c,arrayClear:a,arrayPeek:l,regExpEscape:D,has:f,isArray:In,isBoolean:d,isEmpty:p,isFinite:_n,isFloat:m,isFunction:g,isInteger:h,isjQuery:v,isjQueryNotEmpty:w,isNaN:On,isNil:N,isNotNull:E,isNull:y,isNumber:S,isObject:b,isObjectLiteral:A,isString:T,isStringFloat:F,isStringInteger:I,isStringNumber:_,isUndefined:O,objectEmpty:C,randomNumber:P,stringContains:L,stringFormat:j,toInteger:k,toString:U,trim:R}}(window,window.document,window.jQuery),App.core.api=function(n,t,e,r){function i(){T||(s(),c(),T=!0)}function o(){F=null,T=!1}function u(){return N}function s(){F=e(t)}function c(){n.NProgress.configure({minimum:.1,showSpinner:!1}),F.ajaxStart(function(){n.NProgress.start()}),F.ajaxStop(function(){n.NProgress.done()})}function a(t){if(t.status>=A.OK&&t.status<A.MULTIPLE_CHOICES)return t;var e=new n.Error(t.statusText);throw e.response=t,e}function l(n){try{return n.json()}catch(t){return n}}function f(t,e,i,o){return new n.Promise(function(u,s){if(t=v(t,i),t=w()+y(t),r.isDebug())n.setTimeout(function(){0===r.randomNumber(0,1e3)?s():u()},r.randomNumber(S,5*S));else{var c={method:e,headers:{Accept:"application/json","Content-Type":"application/json"}},f=e===b.PUT||e===b.POST;f&&(n.console.log("fetch() body...",o),c.body=n.JSON.stringify(o)),n.console.log("fetch() in progress...",t,c),n.fetch(t,c).then(a).then(l).then(function(n){u(n)})["catch"](function(n){s(n)})}})}function g(){n.NProgress.start(),n.setTimeout(n.NProgress.done,S)}function d(t,e){return new n.Promise(function(r,i){n.NProgress.start(),f(t,b.DELETE,e).then(function(t){n.NProgress.done(),r(t)})["catch"](function(t){n.NProgress.done(),i(t)})})}function p(t,e){return new n.Promise(function(r,i){n.NProgress.start(),f(t,b.GET,e).then(function(t){n.NProgress.done(),r(t)})["catch"](function(t){n.NProgress.done(),i(t)})})}function m(t,e,r){return new n.Promise(function(i,o){n.NProgress.start(),f(t,b.PUT,e,r).then(function(t){n.NProgress.done(),i(t)})["catch"](function(t){n.NProgress.done(),o(t)})})}function h(t,e,r){return new n.Promise(function(i,o){n.NProgress.start(),f(t,b.POST,e,r).then(function(t){n.NProgress.done(),i(t)})["catch"](function(t){n.NProgress.done(),o(t)})})}function v(n,t){if(!r.isString(n)||!r.isObjectLiteral(t))return n;var e=/{([^{}]*)}/g;return r.toString(n).replace(e,function(n,e){return r.has(t,e)&&!r.isUndefined(t[e])?t[e]:n})}function w(){return I}function E(n){r.isString(n)&&0!==n.trim().length&&(I=y(n)+"/")}function y(n){return r.isString(n)?r.trim(n,"/"):""}var N="1.0.0",S=250,b={DELETE:"delete",GET:"get",PATCH:"patch",POST:"post",PUT:"put"},A={OK:200,CREATED:201,NO_CONTENT:204,MULTIPLE_CHOICES:300,NOT_MODIFIED:304,BAD_REQUEST:400,UNAUTHORIZED:401,FORBIDDEN:403,NOT_FOUND:404,METHOD_NOT_ALLOWED:405,NOT_ACCEPTABLE:406,CONFLICT:409,INTERNAL_SERVER_ERROR:500,NOT_IMPLEMENTED:501},T=!1,F=null,I="";return e(function(){i({})}),{init:i,destroy:o,getVersion:u,Methods:b,HTTPStatus:A,fetch:g,"delete":d,get:p,put:m,post:h,parseUrl:v,getPrefix:w,setPrefix:E,trimSlashes:y}}(window,window.document,window.jQuery,window.App.core),App.core.emitter=function(n,t,e,r){function i(){return h}function o(n){l(n,E),l(n,y)}function u(n){if(d(n)){for(var t=[],e=1,r=arguments.length;r>e;e++)t.push(arguments[e]);f(n,t,E),f(n,t,y),l(n,y)}}function s(n,t){d(n)&&r.isFunction(t)&&(p(n,t,E),p(n,t,y))}function c(n,t){d(n)&&r.isFunction(t)&&m(n,t,E)}function a(n,t){d(n)&&r.isFunction(t)&&m(n,t,y)}function l(n,t){return d(n)?void(g(t[n])&&(t[n]=[])):void(t=r.objectEmpty())}function f(t,e,r){var i=r[t];g(i)&&i.forEach(function(t){n.setTimeout(function(){t.apply(this,e)}.bind(this),0)})}function g(n){return r.isArray(n)&&n.length>0}function d(n){return r.isString(n)&&n.trim().length>0}function p(n,t,e){var r=e[n];if(g(r)){var i=r.indexOf(t);i!==v&&r.splice(i,w)}}function m(n,t,e){e[n]=e[n]||[];var r=e[n];r.indexOf(t)===v&&r.push(t)}var h="1.0.0",v=-1,w=1,E=r.objectEmpty(),y=r.objectEmpty();return{getVersion:i,clear:o,emit:u,off:s,on:c,one:a}}(window,window.document,window.jQuery,window.App.core),App.core.events={NAVIGATION_CLICK:"click.navigation.app",USER_SELECT:"change.user.app"},App.core.session=function(n,t){function e(n,t){return new r(n,t)}function r(n,e){this._key=t.isString(n)&&0===n.length?u+n:u,this._storage=e,this._has=i(this._storage),this._has||(this._storage=s,this._has=i(this._storage))}function i(n){return t.isObject(n)&&"key"in n&&"getItem"in n&&"setItem"in n&&"removeItem"in n&&"clear"in n}var o="1.0.0",u="3943925F-EDCC-45E2-B451-8F0178F6BB24",s=n.sessionStorage;return r.prototype={clear:function(){try{this._storage.removeItem(this._key)}catch(t){n.console.log("An error occurred with Session.clear()",t)}},get:function(){var t=null;try{t=this._storage.getItem(this._key)}catch(e){n.console.log("An error occurred with Session.get()",e)}return t},has:function(){return this._has},remove:this.clear,set:function(e){try{t.isEmpty(e)||this._storage.setItem(this._key,e)}catch(r){n.console.log("An error occurred with Session.set()",r)}},getVersion:function(){return o}},{create:e}}(window,window.App.core),App.navigation=function(n,t,e,r){function i(){a(),s()}function o(){c(),d=null,p=null}function u(){return f}function s(){g&&c(),p.on(m.navigation,m.navigationFn),g=!0}function c(){g&&(p.off(m.navigation,m.navigationFn),g=!1)}function a(){d=e("html, body"),p=d.find("header").find("a")}function l(n,t){r.isUndefined(t)&&(t=500),d.animate({scrollTop:n.offset().top},t)}var f="1.0.0",g=!1,d=null,p=null,m={navigation:r.events.NAVIGATION_CLICK,navigationFn:function(t){var i=t.currentTarget.getAttribute("href"),o="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",u=new n.RegExp("^#"+o+"$");if(r.emitter.emit(r.events.NAVIGATION_CLICK,i),!u.test(i))return!0;t.preventDefault();var s=e(i);return r.isjQueryNotEmpty(s)?(l(s,500),!1):!1}};return e(function(){i()}),{init:i,destroy:o,getVersion:u}}(window,window.document,window.jQuery,window.App.core),App.user=function(n,t,e,r){function i(n){if(!m){var t={};e.extend(t,n),w=n.templates.userList,a(n.dom),s(),r.api.setPrefix("api"),y.usersFn(),m=!0}}function o(){c(),h=null,m=!1}function u(){return f}function s(){p&&c(),r.emitter.on(y.signIn,y.signInFn),h.on(y.select,y.selectFn),p=!0}function c(){p&&(r.emitter.off(y.signInEvent,y.signIn),h.off(y.select,y.selectFn),p=!1)}function a(n){var t=e(n.html);h=t.find(n.userList)}function l(n){var t=h.handlebars("add",w,n,{removeType:"same",type:"COMPILED",validate:!r.isEmpty(n)});h.append(t)}var f="1.0.0",g="B33D672B-E507-478E-99D1-3B0CA10CD765",d={USERS:"users"},p=!1,m=!1,h=null,v=["softwarespot","squidge","brainbox"],w=null,E=r.session.create(g+"_users.app"),y={select:r.events.USER_SELECT,signIn:r.events.NAVIGATION_CLICK,selectFn:function(){var n=event.currentTarget.value;r.isString(n)&&r.emitter.emit(y.select,n)},usersFn:function(){var t=E.get();return r.isNull(t)?void r.api.get(d.USERS).then(function(t){r.isDebug()&&(t=v),E.set(n.JSON.stringify(t)),l({usernames:t})})["catch"](function(){l(null)}):void l({usernames:n.JSON.parse(t)})},signInFn:function(t){"#signin-section"===t&&n.console.log("Sign in was called, but nothing took place as of yet")}};return e(function(){i({dom:{html:"#weight-post-form",userList:'select[name="username"]'},templates:{userList:"#template-user-list"}})}),{init:i,destroy:o,getVersion:u}}(window,window.document,window.jQuery,window.App.core),App.weight=function(n,t,e,r){function i(n){if(!F){var t={};e.extend(t,n),V=n.dataId,Q=n.templates.weightList,s(n.dom),c(),M.prop("disabled",!0),Y.addClass("hide"),r.api.setPrefix("api"),w(),F=!0}}function o(){a(),j=null,k=null,D=null,U=null,R=null,x=null,M=null,Y=null,B=null,r.arrayClear(d()),F=!1}function u(){return N}function s(n){var r=e(n.html);k=r.find(n.weightList),D=r.find(n.displayAll),U=r.find(n.forms.weight),R=U.find('input[type="text"]'),x=U.find('[type="reset"]'),M=U.find('input[type="submit"]'),Y=r.find(n.weightListError),B=r.find(n.weightChart),j=e(t)}function c(){T&&a(),r.emitter.on($.select,$.selectFn),j.on($.remove,"["+V+"]",$.removeFn),D.on($.checked,$.displayAllFn),U.on($.submit,$.submitFn),R.on($.keyup,$.keyupFn),x.on($.reset,$.resetFn),T=!0}function a(){T&&(r.emitter.off($.select,$.selectFn),j.off($.remove,"["+V+"]",$.removeFn),D.off($.checked,$.displayAllFn),U.off($.submit,$.submitFn),R.off($.keyup,$.keyupFn),x.off($.reset,$.resetFn),T=!1)}function l(n){return n=r.toString(n),!r.isEmpty(n)&&W.test(n)}function f(t){if(r.isNull(t))return!1;var e=n.moment(t.time),i=e.format(A);return!P&&_.has(i)?!1:(t.moment=e,t.iso8601=t.moment.toISOString(),_.add(i),I.push(t),!0)}function g(t){if(r.isFloat(t)||(t=n.parseFloat(t)),0===t)return null;var e=0;return n.moment.isMoment(O)?(e=O.valueOf(),O=O.add(1,"days")):e=n.moment().valueOf(),{id:C++,value:t,time:e,username:L}}function d(n){if(!r.isInteger(n)||0>n||n>=I.length)return I;var t=I[n];return r.isUndefined(t)?I:t}function p(t){if(r.isInteger(t)||(t=n.parseInt(t)),0===t)return null;for(var e=0,i=I.length;i>e;e++){var o=I[e];if(o.id===t)return o.username}return null}function m(t){if(r.isInteger(t)||(t=n.parseInt(t)),0!==t)for(var e=0,i=I.length;i>e;e++){var o=I[e];if(o.id===t){I.splice(e,1);break}}}function h(){r.isArray(I)&&0!==I.length&&I.sort(function(n,t){return n.time<t.time?-1:n.time>t.time?1:0})}function v(n){k.handlebars("add",Q,n,{removeType:"same",validate:!r.isEmpty(n)})}function w(t){if(!r.isArray(t)||0===t.length)return void B.hide();B.show(),r.isNull(H)?H=new n.Chart(B.get(0).getContext("2d")):G.destroy();var e="YYYY/MM/DD",i=new n.Set,o=[];t.forEach(function(t){var r=n.moment(t.moment).format(e);i.has(r)||(i.add(r),o.push(t.value))});var u={labels:n.Array.from(i),datasets:[{label:"Weight values",fillColor:"rgba(220,220,220,0.2)",strokeColor:"rgba(220,220,220,1)",pointColor:"rgba(220,220,220,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:o}]};G=H.Line(u)}function E(n){return r.stringContains(n,",")?n.replace(",","."):n}function y(){I=J.get(),_.clear();var n=r.arrayPeek(I);r.isNil(n)||(C=n.id),C++}var N="1.0.0",S="772C021E-61EA-4B15-8330-B2274E891371",b={USERS:"users",WEIGHT_BY_ID:"weights/{id}",WEIGHT_BY_USERNAME_AND_ID:"users/{username}/weights/{id}",WEIGHTS_ALL:"weights",WEIGHTS_BY_USERNAME:"users/{username}/weights"},A="YYYYMMDD",T=!1,F=!1,I=[],_=new n.Set,O=null,C=0,P=!1,D=null,L=null,j=null,k=null,U=null,R=null,x=null,M=null,B=null,H=null,G=null,Y=null,V=null,Q=null,W=/^(?!0+)(?:\d+(?:[.,]\d)?)$/,$={checked:"change.display_all.weight.app",keyup:"keyup.weight.app",remove:"click.remove.weight.app",reset:"click.reset.weight.app",select:r.events.USER_SELECT,submit:"submit.weight.app",displayAllFn:function(n){var t=n.currentTarget;P=t.checked,r.emitter.emit($.select,L)},keyupFn:function(n){n.preventDefault();var t=n.currentTarget.value;return l(t)?void M.prop("disabled",!1):void M.prop("disabled",!0)},resetFn:function(){n.NProgress.done(),L=null,Y.addClass("hide"),J.clear(),r.arrayClear(d()),v(d()),w(d())},removeFn:function(t){t.preventDefault();var e=t.currentTarget.getAttribute(V);r.api["delete"](b.WEIGHT_BY_USERNAME_AND_ID,{id:e,username:p(e)}).then(function(){m(e),J.set(d()),v(d()),w(d())})["catch"](function(){n.console.log("Some error occurred with DELETE'in the weight value")})},selectFn:function(t){t=r.isUndefined(t)?L:t,r.isEmpty(t)||(L=t,r.api.get(b.WEIGHTS_BY_USERNAME,{username:L}).then(function(t){if(J.clear(),y(),r.isDebug()){var e=r.randomNumber(5,20);n.moment.isMoment(O)||(O=n.moment().subtract(e+r.randomNumber(5,200),"days"));for(var i=0;e>i;i++)f(g(1*r.randomNumber(45,200)));O=null}else t.forEach(function(n){f(n)});h(),J.set(d()),y(),v(d()),w(d())})["catch"](function(){$.resetFn()}))},submitFn:function(t){t.preventDefault();var e=t.currentTarget[0];M.prop("disabled",!0);var i=e.value;return l(i)?(R.val(""),Y.addClass("hide"),i=E(i),void r.api.post(b.WEIGHTS_BY_USERNAME,{username:L},{id:0,value:i,time:0,username:L}).then(function(){if(r.isDebug()){var n=g(i);f(n)&&(h(),J.set(d()),v(d()),w(d()))}else $.selectFn()})["catch"](function(){n.console.log("Some error occurred with POST'in the weight value")})):void Y.removeClass("hide")}},K=r.session.create(S+"_weight_list.app"),J={clear:function(){K.clear()},has:function(){return K.has()},remove:this.clear,get:function(){var t=K.get();return r.isEmpty(t)?[]:n.JSON.parse(t)},set:function(t){r.isArray(t)&&K.set(n.JSON.stringify(t))}};return e(function(){i({dataId:"data-weight-id",dom:{html:"#weight-section",forms:{weight:"#weight-post-form"},displayAll:'[name="display-all"]',weightChart:"#weight-chart",weightList:"#weight-list",weightListError:"#weight-list-error"},templates:{weightList:"#template-weight-list"}})}),{init:i,destroy:o,getVersion:u,isValidWeight:l}}(window,window.document,window.jQuery,window.App.core);